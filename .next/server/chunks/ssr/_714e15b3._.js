module.exports=[82520,(a,b,c)=>{"use strict";b.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},24560,(a,b,c)=>{"use strict";var d=a.r(82520);function e(){}function f(){}f.resetWarningCache=e,b.exports=function(){function a(a,b,c,e,f,g){if(g!==d){var h=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw h.name="Invariant Violation",h}}function b(){return a}a.isRequired=a;var c={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:b,element:a,elementType:a,instanceOf:b,node:a,objectOf:b,oneOf:b,oneOfType:b,shape:b,exact:b,checkPropTypes:f,resetWarningCache:e};return c.PropTypes=c,c}},41212,(a,b,c)=>{b.exports=a.r(24560)()},27615,a=>{"use strict";var b,c,d,e=a.i(87924),f=a.i(72131),g=a.i(50944),h=a.i(46271),i=a.i(73320),j=a.i(4720),k=a.i(84505),l=a.i(49199),m=a.i(40695),n=a.i(3130),o=a.i(5522),p=a.i(17171),q=a.i(65602),r=a.i(2150),s=a.i(54161),t=a.i(7379),u=a.i(41212),v=function(){return(v=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)},w={onActivate:u.func,onAddUndo:u.func,onBeforeAddUndo:u.func,onBeforeExecCommand:u.func,onBeforeGetContent:u.func,onBeforeRenderUI:u.func,onBeforeSetContent:u.func,onBeforePaste:u.func,onBlur:u.func,onChange:u.func,onClearUndos:u.func,onClick:u.func,onContextMenu:u.func,onCommentChange:u.func,onCompositionEnd:u.func,onCompositionStart:u.func,onCompositionUpdate:u.func,onCopy:u.func,onCut:u.func,onDblclick:u.func,onDeactivate:u.func,onDirty:u.func,onDrag:u.func,onDragDrop:u.func,onDragEnd:u.func,onDragGesture:u.func,onDragOver:u.func,onDrop:u.func,onExecCommand:u.func,onFocus:u.func,onFocusIn:u.func,onFocusOut:u.func,onGetContent:u.func,onHide:u.func,onInit:u.func,onInput:u.func,onKeyDown:u.func,onKeyPress:u.func,onKeyUp:u.func,onLoadContent:u.func,onMouseDown:u.func,onMouseEnter:u.func,onMouseLeave:u.func,onMouseMove:u.func,onMouseOut:u.func,onMouseOver:u.func,onMouseUp:u.func,onNodeChange:u.func,onObjectResizeStart:u.func,onObjectResized:u.func,onObjectSelected:u.func,onPaste:u.func,onPostProcess:u.func,onPostRender:u.func,onPreProcess:u.func,onProgressState:u.func,onRedo:u.func,onRemove:u.func,onReset:u.func,onSaveContent:u.func,onSelectionChange:u.func,onSetAttrib:u.func,onSetContent:u.func,onShow:u.func,onSubmit:u.func,onUndo:u.func,onVisualAid:u.func,onSkinLoadError:u.func,onThemeLoadError:u.func,onModelLoadError:u.func,onPluginLoadError:u.func,onIconsLoadError:u.func,onLanguageLoadError:u.func,onScriptsLoad:u.func,onScriptsLoadError:u.func},x=v({apiKey:u.string,licenseKey:u.string,id:u.string,inline:u.bool,init:u.object,initialValue:u.string,onEditorChange:u.func,value:u.string,tagName:u.string,tabIndex:u.number,cloudChannel:u.string,plugins:u.oneOfType([u.string,u.array]),toolbar:u.oneOfType([u.string,u.array]),disabled:u.bool,readonly:u.bool,textareaName:u.string,tinymceScriptSrc:u.oneOfType([u.string,u.arrayOf(u.string),u.arrayOf(u.shape({src:u.string,async:u.bool,defer:u.bool}))]),rollback:u.oneOfType([u.number,u.oneOf([!1])]),scriptLoading:u.shape({async:u.bool,defer:u.bool,delay:u.number})},w),y=function(a){return a&&a.tinymce?a.tinymce:null},z=function(a){return"function"==typeof a},A=function(a){return a in w},B=function(a){return a.substr(2)},C=function(a,b,c,d,e,f,g){var h=Object.keys(e).filter(A),i=Object.keys(f).filter(A),j=h.filter(function(a){return void 0===f[a]}),k=i.filter(function(a){return void 0===e[a]});j.forEach(function(a){var b=B(a),d=g[b];c(b,d),delete g[b]}),k.forEach(function(c){var e=d(a,c),f=B(c);g[f]=e,b(f,e)})},D=0,E=function(a){var b=Date.now();return a+"_"+Math.floor(1e9*Math.random())+ ++D+String(b)},F=function(a){return null!==a&&("textarea"===a.tagName.toLowerCase()||"input"===a.tagName.toLowerCase())},G=function(a){return void 0===a||""===a?[]:Array.isArray(a)?a:a.split(" ")},H=function(a){if(!("isConnected"in Node.prototype)){for(var b=a,c=a.parentNode;null!=c;)c=(b=c).parentNode;return b===a.ownerDocument}return a.isConnected},I=function(a,b){void 0!==a&&(null!=a.mode&&"object"==typeof a.mode&&"function"==typeof a.mode.set?a.mode.set(b):a.setMode(b))},J=function(a){var b=y(a);if(!b)throw Error("tinymce should have been loaded into global scope");return b},K=function(a){return a.options&&a.options.isRegistered("disabled")},L=function(){return(L=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)},M=function(a,b,c){var d,e,f=a.createElement("script");f.referrerPolicy="origin",f.type="application/javascript",f.id=b.id,f.src=b.src,f.async=null!=(d=b.async)&&d,f.defer=null!=(e=b.defer)&&e;var g=function(){f.removeEventListener("load",g),f.removeEventListener("error",h),c(b.src)},h=function(a){f.removeEventListener("load",g),f.removeEventListener("error",h),c(b.src,a)};f.addEventListener("load",g),f.addEventListener("error",h),a.head&&a.head.appendChild(f)},N=function(a){var b={},c=function(a,c){var d=b[a];d.done=!0,d.error=c;for(var e=0,f=d.handlers;e<f.length;e++)(0,f[e])(a,c);d.handlers=[]};return{loadScripts:function(d,e,f){var g=function(a){return void 0!==f?f(a):console.error(a)};if(0===d.length)return void g(Error("At least one script must be provided"));for(var h=0,i=!1,j=function(a,b){i||(b?(i=!0,g(b)):++h===d.length&&e())},k=0;k<d.length;k++){var l=d[k],m=b[l.src];if(m)m.done?j(l.src,m.error):m.handlers.push(j);else{var n=E("tiny-");b[l.src]={id:n,src:l.src,done:!1,error:null,handlers:[j]},M(a,L({id:n},l),c)}}},deleteScripts:function(){for(var c,d=0,e=Object.values(b);d<e.length;d++){var f=e[d],g=a.getElementById(f.id);null!=g&&"SCRIPT"===g.tagName&&(null==(c=g.parentNode)||c.removeChild(g))}b={}},getDocument:function(){return a}}},O=(b=[],c=function(a){var c=b.find(function(b){return b.getDocument()===a});return void 0===c&&(c=N(a),b.push(c)),c},{loadList:function(a,b,d,e,f){var g=function(){return c(a).loadScripts(b,e,f)};d>0?setTimeout(g,d):g()},reinitialize:function(){for(var a=b.pop();null!=a;a=b.pop())a.deleteScripts()}}),P=(d=function(a,b){return(d=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])})(a,b)},function(a,b){if("function"!=typeof b&&null!==b)throw TypeError("Class extends value "+String(b)+" is not a constructor or null");function c(){this.constructor=a}d(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}),Q=function(){return(Q=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)},R="change keyup compositionend setcontent CommentChange",S=function(a){function b(b){var c,d,e,g=a.call(this,b)||this;return g.rollbackTimer=void 0,g.valueCursor=void 0,g.rollbackChange=function(){var a=g.editor,b=g.props.value;a&&b&&b!==g.currentContent&&a.undoManager.ignore(function(){if(a.setContent(b),g.valueCursor&&(!g.inline||a.hasFocus()))try{a.selection.moveToBookmark(g.valueCursor)}catch(a){}}),g.rollbackTimer=void 0},g.handleBeforeInput=function(a){if(void 0!==g.props.value&&g.props.value===g.currentContent&&g.editor&&(!g.inline||g.editor.hasFocus()))try{g.valueCursor=g.editor.selection.getBookmark(3)}catch(a){}},g.handleBeforeInputSpecial=function(a){("Enter"===a.key||"Backspace"===a.key||"Delete"===a.key)&&g.handleBeforeInput(a)},g.handleEditorChange=function(a){var b=g.editor;if(b&&b.initialized){var c=b.getContent();void 0===g.props.value||g.props.value===c||!1===g.props.rollback||g.rollbackTimer||(g.rollbackTimer=window.setTimeout(g.rollbackChange,"number"==typeof g.props.rollback?g.props.rollback:200)),c!==g.currentContent&&(g.currentContent=c,z(g.props.onEditorChange)&&g.props.onEditorChange(c,b))}},g.handleEditorChangeSpecial=function(a){("Backspace"===a.key||"Delete"===a.key)&&g.handleEditorChange(a)},g.initialise=function(a){void 0===a&&(a=0);var b,c,d,e=g.elementRef.current;if(e){if(!H(e)){if(0===a)setTimeout(function(){return g.initialise(1)},1);else if(a<100)setTimeout(function(){return g.initialise(a+1)},100);else throw Error("tinymce can only be initialised when in a document");return}var f,h,i=J(g.view),j=Q(Q(Q(Q({},g.props.init),{selector:void 0,target:e,disabled:g.props.disabled,readonly:g.props.readonly,inline:g.inline,plugins:(f=null==(b=g.props.init)?void 0:b.plugins,h=g.props.plugins,G(f).concat(G(h))),toolbar:null!=(c=g.props.toolbar)?c:null==(d=g.props.init)?void 0:d.toolbar}),g.props.licenseKey?{license_key:g.props.licenseKey}:{}),{setup:function(a){g.editor=a,g.bindHandlers({}),g.inline&&!F(e)&&a.once("PostRender",function(b){a.setContent(g.getInitialValue(),{no_events:!0})}),g.props.init&&z(g.props.init.setup)&&g.props.init.setup(a),g.props.disabled&&(K(g.editor)?g.editor.options.set("disabled",g.props.disabled):g.editor.mode.set("readonly"))},init_instance_callback:function(a){var b,c=g.getInitialValue();g.currentContent=null!=(b=g.currentContent)?b:a.getContent(),g.currentContent!==c&&(g.currentContent=c,a.setContent(c),a.undoManager.clear(),a.undoManager.add(),a.setDirty(!1)),g.props.init&&z(g.props.init.init_instance_callback)&&g.props.init.init_instance_callback(a)}});g.inline||(e.style.visibility=""),F(e)&&(e.value=g.getInitialValue()),i.init(j)}},g.id=g.props.id||E("tiny-react"),g.elementRef=f.createRef(),g.inline=null!=(e=null!=(c=g.props.inline)?c:null==(d=g.props.init)?void 0:d.inline)&&e,g.boundHandlers={},g}return P(b,a),Object.defineProperty(b.prototype,"view",{get:function(){var a,b;return null!=(b=null==(a=this.elementRef.current)?void 0:a.ownerDocument.defaultView)?b:window},enumerable:!1,configurable:!0}),b.prototype.componentDidUpdate=function(a){var b,c,d=this;if(this.rollbackTimer&&(clearTimeout(this.rollbackTimer),this.rollbackTimer=void 0),this.editor&&(this.bindHandlers(a),this.editor.initialized)){if(this.currentContent=null!=(b=this.currentContent)?b:this.editor.getContent(),"string"==typeof this.props.initialValue&&this.props.initialValue!==a.initialValue)this.editor.setContent(this.props.initialValue),this.editor.undoManager.clear(),this.editor.undoManager.add(),this.editor.setDirty(!1);else if("string"==typeof this.props.value&&this.props.value!==this.currentContent){var e=this.editor;e.undoManager.transact(function(){if(!d.inline||e.hasFocus())try{a=e.selection.getBookmark(3)}catch(a){}var a,b=d.valueCursor;if(e.setContent(d.props.value),!d.inline||e.hasFocus())for(var c=0,f=[a,b];c<f.length;c++){var g=f[c];if(g)try{e.selection.moveToBookmark(g),d.valueCursor=g;break}catch(a){}}})}if(this.props.readonly!==a.readonly){var f=null!=(c=this.props.readonly)&&c;I(this.editor,f?"readonly":"design")}this.props.disabled!==a.disabled&&(K(this.editor)?this.editor.options.set("disabled",this.props.disabled):I(this.editor,this.props.disabled?"readonly":"design"))}},b.prototype.componentDidMount=function(){var a,b,c,d,e,f=this;null!==y(this.view)?this.initialise():Array.isArray(this.props.tinymceScriptSrc)&&0===this.props.tinymceScriptSrc.length?null==(b=(a=this.props).onScriptsLoadError)||b.call(a,Error("No `tinymce` global is present but the `tinymceScriptSrc` prop was an empty array.")):(null==(c=this.elementRef.current)?void 0:c.ownerDocument)&&O.loadList(this.elementRef.current.ownerDocument,this.getScriptSources(),null!=(e=null==(d=this.props.scriptLoading)?void 0:d.delay)?e:0,function(){var a,b;null==(b=(a=f.props).onScriptsLoad)||b.call(a),f.initialise()},function(a){var b,c;null==(c=(b=f.props).onScriptsLoadError)||c.call(b,a)})},b.prototype.componentWillUnmount=function(){var a=this,b=this.editor;b&&(b.off(R,this.handleEditorChange),b.off(this.beforeInputEvent(),this.handleBeforeInput),b.off("keypress",this.handleEditorChangeSpecial),b.off("keydown",this.handleBeforeInputSpecial),b.off("NewBlock",this.handleEditorChange),Object.keys(this.boundHandlers).forEach(function(c){b.off(c,a.boundHandlers[c])}),this.boundHandlers={},b.remove(),this.editor=void 0)},b.prototype.render=function(){return this.inline?this.renderInline():this.renderIframe()},b.prototype.beforeInputEvent=function(){return window.InputEvent&&"function"==typeof InputEvent.prototype.getTargetRanges?"beforeinput SelectionChange":"SelectionChange"},b.prototype.renderInline=function(){var a=this.props.tagName;return f.createElement(void 0===a?"div":a,{ref:this.elementRef,id:this.id,tabIndex:this.props.tabIndex})},b.prototype.renderIframe=function(){return f.createElement("textarea",{ref:this.elementRef,style:{visibility:"hidden"},name:this.props.textareaName,id:this.id,tabIndex:this.props.tabIndex})},b.prototype.getScriptSources=function(){var a,b,c=null==(a=this.props.scriptLoading)?void 0:a.async,d=null==(b=this.props.scriptLoading)?void 0:b.defer;if(void 0!==this.props.tinymceScriptSrc)return"string"==typeof this.props.tinymceScriptSrc?[{src:this.props.tinymceScriptSrc,async:c,defer:d}]:this.props.tinymceScriptSrc.map(function(a){return"string"==typeof a?{src:a,async:c,defer:d}:a});var e=this.props.cloudChannel,f=this.props.apiKey?this.props.apiKey:"no-api-key";return[{src:"https://cdn.tiny.cloud/1/".concat(f,"/tinymce/").concat(e,"/tinymce.min.js"),async:c,defer:d}]},b.prototype.getInitialValue=function(){return"string"==typeof this.props.initialValue?this.props.initialValue:"string"==typeof this.props.value?this.props.value:""},b.prototype.bindHandlers=function(a){var b=this;if(void 0!==this.editor){c=this.editor,d=this.props,e=this.boundHandlers,C(function(a){return b.props[a]},c.on.bind(c),c.off.bind(c),function(a,b){return function(d){var e;return null==(e=a(b))?void 0:e(d,c)}},a,d,e);var c,d,e,f=function(a){return void 0!==a.onEditorChange||void 0!==a.value},g=f(a),h=f(this.props);!g&&h?(this.editor.on(R,this.handleEditorChange),this.editor.on(this.beforeInputEvent(),this.handleBeforeInput),this.editor.on("keydown",this.handleBeforeInputSpecial),this.editor.on("keyup",this.handleEditorChangeSpecial),this.editor.on("NewBlock",this.handleEditorChange)):g&&!h&&(this.editor.off(R,this.handleEditorChange),this.editor.off(this.beforeInputEvent(),this.handleBeforeInput),this.editor.off("keydown",this.handleBeforeInputSpecial),this.editor.off("keyup",this.handleEditorChangeSpecial),this.editor.off("NewBlock",this.handleEditorChange))}},b.propTypes=x,b.defaultProps={cloudChannel:"8"},b}(f.Component);let T=(0,f.forwardRef)(({content:a,onContentChange:b,suggestions:c=[],selectedSuggestionIndex:d=null,className:g},h)=>{let i=(0,f.useRef)(null);return(0,f.useImperativeHandle)(h,()=>({highlightText:a=>{i.current&&U(i.current,a)},replaceText:(a,b)=>{i.current&&V(i.current,a,b)},getEditor:()=>i.current,getContent:()=>i.current?.getContent()||""})),(0,f.useEffect)(()=>{i.current&&a!==i.current.getContent()&&i.current.setContent(a)},[a]),(0,f.useEffect)(()=>{if(i.current&&null!==d&&c[d]){let a=c[d],b=a.text||a.original||"";b&&U(i.current,b)}},[d,c]),(0,e.jsx)(n.Card,{className:`border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900 ${g||""}`,children:(0,e.jsx)(n.CardContent,{className:"p-0",children:(0,e.jsx)(S,{onInit:(a,b)=>{i.current=b},value:a,onEditorChange:a=>{b(a)},init:{height:"70vh",menubar:!1,plugins:["advlist","autolink","lists","link","image","charmap","preview","anchor","searchreplace","visualblocks","code","fullscreen","insertdatetime","media","table","code","help","wordcount","textcolor","colorpicker","textpattern","nonbreaking","paste"],toolbar:"undo redo | blocks | bold italic underline strikethrough | forecolor backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | help",content_style:"body { font-family: -apple-system, BlinkMacSystemFont, San Francisco, Segoe UI, Roboto, Helvetica Neue, sans-serif; font-size: 14px; padding: 20px; line-height: 1.6; }",skin:"oxide",content_css:"default",branding:!1,promotion:!1,resize:!0,statusbar:!1,menubar:!1,paste_as_text:!1,paste_auto_cleanup_on_paste:!0,convert_urls:!1,setup:a=>{a.addCommand("highlightText",b=>{U(a,b)}),a.addCommand("replaceText",(b,c)=>{V(a,b,c)})}}})})})});function U(a,b){if(b&&b.trim())try{a.getBody().querySelectorAll("mark.suggestion-highlight").forEach(a=>{let b=a.parentNode;if(b){for(;a.firstChild;)b.insertBefore(a.firstChild,a);b.removeChild(a),b.normalize()}});let c=a.getContent({format:"text"}),d=b.trim().toLowerCase(),e=c.toLowerCase().indexOf(d);if(-1===e)return void console.warn("Text not found in editor:",b);let f=a.getContent(),g=document.createElement("div");g.innerHTML=f;let h=document.createTreeWalker(g,NodeFilter.SHOW_TEXT,null),i=null,j=!1;for(;(i=h.nextNode())&&!j;){let a=i,b=a.textContent||"",c=b.toLowerCase();b.length;let e=c.indexOf(d);if(-1!==e){let c=b.substring(0,e),f=b.substring(e,e+d.length),g=b.substring(e+d.length),h=document.createDocumentFragment();c&&h.appendChild(document.createTextNode(c));let i=document.createElement("mark");i.className="suggestion-highlight",i.setAttribute("style","background-color: #fef08a; color: #000; padding: 2px 4px; border-radius: 3px;"),i.textContent=f,h.appendChild(i),g&&h.appendChild(document.createTextNode(g)),a.parentNode?.replaceChild(h,a),j=!0}}j&&(a.setContent(g.innerHTML),setTimeout(()=>{let b=a.getBody().querySelector("mark.suggestion-highlight");b&&(a.selection.select(b),a.selection.scrollIntoView(),b.scrollIntoView({behavior:"smooth",block:"center"}))},100))}catch(a){console.error("Error highlighting text in TinyMCE:",a)}}function V(a,b,c){if(b&&b.trim())try{a.getBody().querySelectorAll("mark.suggestion-highlight").forEach(a=>{let b=a.parentNode;if(b){for(;a.firstChild;)b.insertBefore(a.firstChild,a);b.removeChild(a),b.normalize()}});let d=a.getContent(),e=a.getContent({format:"text"}),f=b.trim().toLowerCase(),g=e.toLowerCase().indexOf(f);if(-1===g)return void console.warn("Text not found in editor for replacement:",b);let h=document.createElement("div");h.innerHTML=d;let i=document.createTreeWalker(h,NodeFilter.SHOW_TEXT,null),j=null,k=!1;for(;(j=i.nextNode())&&!k;){let a=j,b=a.textContent||"",d=b.toLowerCase();b.length;let e=d.indexOf(f);if(-1!==e){let d=b.substring(0,e),g=b.substring(e+f.length),h=document.createDocumentFragment();d&&h.appendChild(document.createTextNode(d)),h.appendChild(document.createTextNode(c)),g&&h.appendChild(document.createTextNode(g)),a.parentNode?.replaceChild(h,a),k=!0}}k&&a.setContent(h.innerHTML)}catch(a){console.error("Error replacing text in TinyMCE:",a)}}T.displayName="TinyMCEEditor";var W=a.i(92475),X=a.i(51168),Y=a.i(66274),Z=a.i(23292),$=a.i(318);async function _(){return await a.A(61751)}function aa(){let a=(0,g.useSearchParams)().get("documentId"),{getDocumentPdfUrl:b,getDocumentContent:c,getDocument:d}=(0,$.useAppContext)(),[u,v]=(0,f.useState)(null),[w,x]=(0,f.useState)(!1),[y,z]=(0,f.useState)(0),[A,B]=(0,f.useState)(null),[C,D]=(0,f.useState)(""),[E,F]=(0,f.useState)([]),[G,H]=(0,f.useState)(null),[I,J]=(0,f.useState)(!1),[K,L]=(0,f.useState)(""),[M,N]=(0,f.useState)(null),[O,P]=(0,f.useState)(null),[Q,R]=(0,f.useState)(null),[S,U]=(0,f.useState)(!1),V=(0,f.useRef)(null);(0,f.useEffect)(()=>()=>{O&&URL.revokeObjectURL(O)},[O]),(0,f.useEffect)(()=>{if(!a)return void console.log("[ComplianceEditor] No documentId provided");console.log("[ComplianceEditor] Loading document:",a),x(!0),B(null);try{let c=d(a);c&&(L(c.title||"document"),console.log("[ComplianceEditor] Document loaded:",c.title));let e=b(a);console.log("[ComplianceEditor] PDF URL retrieved:",e?"exists":"null"),e?(P(e),N("pdf"),console.log("[ComplianceEditor] PDF URL set successfully")):(console.warn("[ComplianceEditor] No PDF URL found for document"),B("No PDF URL found for this document"),P(null))}catch(a){console.error("[ComplianceEditor] Error loading PDF:",a),B("Failed to load PDF"),P(null)}finally{x(!1)}},[a,d,b]),(0,f.useEffect)(()=>{if(!a)return;let b=c(a);b&&(console.log("[ComplianceEditor] Content loaded, analyzing..."),z(10),(0,X.analyzePdfContent)(b).then(a=>{F(a),z(100),Z.toast.success(`Analysis complete! Found ${a.length} suggestions.`)}).catch(a=>{console.error("[ComplianceEditor] Analysis error:",a),Z.toast.error("Failed to analyze document")}))},[a,c]);let aa=async()=>{if(!u)return void B("Please select a document to upload.");x(!0),B(null),F([]),z(10);try{let a=u.name.toLowerCase(),b=a.endsWith(".pdf")||"application/pdf"===u.type,c=a.endsWith(".docx")||u.type.includes("officedocument.wordprocessingml");if(b){N("pdf"),z(20);let a=new FormData;a.append("file",u);let b=await fetch("/api/pdf-to-docx",{method:"POST",body:a});if(!b.ok)throw Error("Failed to convert PDF to DOCX");let c=await b.blob();z(40);let d=await c.arrayBuffer(),e=(await l.default.convertToHtml({arrayBuffer:d})).value||"";D(e),J(!0),z(60);let f=await u.arrayBuffer(),g=await _(),h=await g.getDocument({data:f}).promise,i="";for(let a=1;a<=h.numPages;a++){let b=await h.getPage(a),c=(await b.getTextContent()).items.map(a=>a.str).join(" ");i+=`--- PAGE ${a} ---
${c}
`,z(60+Math.round(a/h.numPages*20))}z(85);let j=await (0,X.analyzePdfContent)(i);F(j),z(100),Z.toast.success(`Document loaded! Found ${j.length} suggestions.`)}else if(c){N("docx"),z(30);let a=await u.arrayBuffer(),b=(await l.default.convertToHtml({arrayBuffer:a})).value||"";D(b),J(!0),z(60);let c=document.createElement("div");c.innerHTML=b;let d=c.textContent||c.innerText||"",e=`--- PAGE 1 ---
${d}`,f=await (0,X.analyzePdfContent)(e);F(f),z(100),Z.toast.success(`Document loaded! Found ${f.length} suggestions.`)}else throw Error("Unsupported file type. Please upload a PDF or DOCX file.")}catch(a){console.error("Failed to process file:",a),B(a instanceof Error?a.message:"Failed to process the file."),Z.toast.error("Failed to process document")}finally{x(!1)}},ab=async()=>{if(!V.current||!I)return void Z.toast.error("No content to save");try{let a=V.current.getContent(),b=await (0,Y.htmlToWordBlob)(a),c=URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=`${K||"document"}_edited.docx`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(c),Z.toast.success("Document downloaded as Word")}catch(a){console.error("Save error:",a),Z.toast.error("Failed to save as Word")}},ac=async()=>{if(!V.current||!I)return void Z.toast.error("No content to save");try{let a=V.current.getContent(),b=await (0,Y.convertHtmlToPdf)(a),c=document.createElement("a");c.href=b,c.download=`${K||"document"}_edited.pdf`,document.body.appendChild(c),c.click(),document.body.removeChild(c),Z.toast.success("Document downloaded as PDF")}catch(a){console.error("Save error:",a),Z.toast.error("Failed to save as PDF")}},ad=async()=>{if(!O)return void Z.toast.error("PDF not available for conversion");U(!0),B(null),z(10);try{let a=await fetch(O),b=await a.blob(),c=new FormData;c.append("file",b,"document.pdf"),z(30);let d=await fetch("/api/pdf-to-docx",{method:"POST",body:c});if(!d.ok)throw Error("Failed to convert PDF to DOCX");let e=await d.blob();z(60);let f=await e.arrayBuffer(),g=(await l.default.convertToHtml({arrayBuffer:f})).value||"";D(g),J(!0),z(100),Z.toast.success("Document converted to editor mode")}catch(a){console.error("Conversion error:",a),B(a instanceof Error?a.message:"Failed to convert PDF"),Z.toast.error("Failed to convert PDF to editor mode")}finally{U(!1)}};(0,f.useEffect)(()=>{console.log("[ComplianceEditor] State:",{file:u?.name,fileType:M,isEditorMode:I,pdfUrl:O?"set":"not set",suggestionsCount:E.length,isLoading:w})},[u,M,I,O,E.length,w]);let ae=E.reduce((a,b,c)=>{let d=b.category||"compliance";return a[d]||(a[d]=[]),a[d].push({...b,index:c}),a},{});return w?(0,e.jsx)("div",{className:"flex flex-col items-center justify-center h-screen bg-zinc-50 dark:bg-zinc-950 text-center gap-4 px-6",children:(0,e.jsxs)(n.Card,{className:"w-full max-w-md border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900",children:[(0,e.jsx)(n.CardHeader,{children:(0,e.jsx)(n.CardTitle,{className:"text-gray-900 dark:text-gray-50",children:"Analyzing Document..."})}),(0,e.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,e.jsx)(r.Progress,{value:y}),(0,e.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:y<30?"Loading document...":y<70?"Extracting text...":"Analyzing compliance..."})]})]})}):(0,e.jsx)(h.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"min-h-screen bg-zinc-50 dark:bg-zinc-950 p-4 sm:p-6 lg:p-8",children:(0,e.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,e.jsxs)("div",{className:"mb-6",children:[(0,e.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-50 mb-2",children:"Financial Compliance Editor"}),(0,e.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Upload documents for FINRA/SEC compliance review and editing"})]}),!I&&!u&&!O&&!a&&(0,e.jsxs)(n.Card,{className:"border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900",children:[(0,e.jsx)(n.CardHeader,{children:(0,e.jsx)(n.CardTitle,{className:"text-gray-900 dark:text-gray-50",children:"Upload Document"})}),(0,e.jsxs)(n.CardContent,{className:"space-y-4",children:[A&&(0,e.jsxs)(q.Alert,{variant:"destructive",children:[(0,e.jsx)(q.AlertTitle,{children:"Error"}),(0,e.jsx)(q.AlertDescription,{children:A})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(p.Label,{htmlFor:"file-upload",children:"Select PDF or Word Document"}),(0,e.jsxs)("div",{className:"flex gap-3",children:[(0,e.jsx)(o.Input,{id:"file-upload",type:"file",accept:".pdf,.docx,application/pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document",onChange:a=>{let b=a.target.files?.[0]||null;v(b),F([]),B(null),D(""),J(!1),O&&(URL.revokeObjectURL(O),P(null)),b&&L(b.name.replace(/\.(pdf|docx)$/i,""))}}),(0,e.jsxs)(m.Button,{onClick:aa,disabled:!u,children:[(0,e.jsx)(i.Upload,{className:"h-4 w-4 mr-2"}),"Analyze"]})]}),(0,e.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Supported formats: PDF, DOCX (up to 10MB)"})]})]})]}),(I||u||O)&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"mb-4 flex justify-between items-center",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsx)(s.Badge,{variant:"outline",children:u?.name||K||"Document"}),E.length>0&&(0,e.jsxs)(s.Badge,{variant:"secondary",children:[E.length," suggestions found"]})]}),(0,e.jsxs)("div",{className:"flex gap-2",children:[O&&"pdf"===M&&!I&&(0,e.jsx)(m.Button,{variant:"default",onClick:ad,disabled:S,children:S?"Converting...":"Edit Document"}),(0,e.jsxs)(m.Button,{variant:"outline",onClick:()=>{v(null),J(!1),F([]),D(""),N(null),P(null),R(null)},children:[(0,e.jsx)(i.Upload,{className:"h-4 w-4 mr-2"}),"New Document"]})]})]}),(0,e.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,e.jsx)("div",{className:"lg:col-span-2",children:I?(0,e.jsxs)(n.Card,{className:"border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900",children:[(0,e.jsx)(n.CardHeader,{className:"pb-2",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsx)(n.CardTitle,{className:"text-gray-900 dark:text-gray-50",children:"Document Editor"}),(0,e.jsxs)("div",{className:"flex gap-2",children:[(0,e.jsxs)(m.Button,{variant:"outline",size:"sm",onClick:ab,children:[(0,e.jsx)(k.Download,{className:"h-4 w-4 mr-2"}),"Download as Word"]}),(0,e.jsxs)(m.Button,{variant:"outline",size:"sm",onClick:ac,children:[(0,e.jsx)(k.Download,{className:"h-4 w-4 mr-2"}),"Download as PDF"]})]})]})}),(0,e.jsx)(n.CardContent,{className:"p-0",children:(0,e.jsx)(T,{ref:V,content:C,onContentChange:D,suggestions:E,selectedSuggestionIndex:G})})]}):O&&"pdf"===M?(0,e.jsx)(W.default,{pdfUrl:O,suggestions:E,selectedSuggestion:Q,onSuggestionClick:R,onApplyEdit:(a,b,c)=>{Z.toast.info("Convert to editor mode to apply changes")}}):(0,e.jsx)(n.Card,{className:"border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900",children:(0,e.jsxs)(n.CardContent,{className:"p-6 text-center text-gray-600 dark:text-gray-400",children:[(0,e.jsx)(j.FileText,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,e.jsx)("p",{children:"Upload a document to get started"})]})})}),(0,e.jsx)("div",{className:"lg:col-span-1",children:(0,e.jsxs)(n.Card,{className:"border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900 sticky top-6",children:[(0,e.jsx)(n.CardHeader,{children:(0,e.jsxs)(n.CardTitle,{className:"text-gray-900 dark:text-gray-50 flex items-center justify-between",children:[(0,e.jsx)("span",{children:"Suggestions"}),(0,e.jsx)(s.Badge,{variant:"secondary",children:E.length})]})}),(0,e.jsx)(n.CardContent,{className:"max-h-[calc(100vh-200px)] overflow-y-auto space-y-4",children:0===E.length?(0,e.jsxs)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[(0,e.jsx)("p",{children:"No suggestions found"}),(0,e.jsx)("p",{className:"text-sm mt-2",children:"Your document looks good!"})]}):(0,e.jsx)(e.Fragment,{children:Object.entries(ae).map(([a,b])=>(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,e.jsx)(s.Badge,{variant:"outline",className:"text-xs",children:(a=>{switch(a){case"compliance":return"Compliance";case"grammar":return"Grammar";case"style":return"Style";default:return a}})(a)}),(0,e.jsx)(t.Separator,{className:"flex-1"})]}),(0,e.jsx)("div",{className:"space-y-3",children:b.map(a=>(0,e.jsx)(n.Card,{className:`border cursor-pointer transition-colors ${G===a.index?"border-emerald-500 dark:border-emerald-600 bg-emerald-50 dark:bg-emerald-950":"border-zinc-200 dark:border-zinc-700"}`,onClick:()=>(a=>{H(a);let b=E[a];if(b)if(I&&V.current){let a=b.text||b.original||"";a&&V.current.highlightText(a)}else O&&"pdf"===M&&R(b)})(a.index),children:(0,e.jsxs)(n.CardContent,{className:"p-3 space-y-2",children:[(0,e.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,e.jsx)(s.Badge,{variant:(a=>{switch(a){case"critical":return"destructive";case"warning":return"default";default:return"secondary"}})(a.severity||"warning"),className:"text-xs",children:a.severity||"warning"}),(0,e.jsxs)("span",{className:"text-xs text-gray-500",children:["Page ",a.page]})]}),(0,e.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:a.issue||a.explanation||"Issue found"}),(0,e.jsxs)("div",{className:"text-xs space-y-1",children:[(0,e.jsxs)("p",{className:"text-red-600 dark:text-red-400",children:[(0,e.jsx)("span",{className:"font-semibold",children:"Original:"})," ",a.text||a.original||""]}),(0,e.jsxs)("p",{className:"text-green-600 dark:text-green-400",children:[(0,e.jsx)("span",{className:"font-semibold",children:"Suggested:"})," ",a.suggestion]})]}),I&&(0,e.jsx)(m.Button,{variant:"default",size:"sm",className:"w-full mt-2",onClick:b=>{b.stopPropagation(),(a=>{let b=E[a];if(!b||!V.current||!I)return;let c=b.text||b.original||"";c?(V.current.replaceText(c,b.suggestion),D(V.current.getContent()),F(b=>b.filter((b,c)=>c!==a)),null!==G&&(G===a?H(null):G>a&&H(G-1)),Z.toast.success("Suggestion applied")):Z.toast.error("No text to replace")})(a.index)},children:"Apply Change"})]})},a.index))})]},a))})})]})})]})]})]})})}a.s(["default",()=>aa],27615)}];

//# sourceMappingURL=_714e15b3._.js.map