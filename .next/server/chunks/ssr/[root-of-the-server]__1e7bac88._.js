module.exports=[874,(a,b,c)=>{b.exports=a.x("buffer",()=>require("buffer"))},92509,(a,b,c)=>{b.exports=a.x("url",()=>require("url"))},46786,(a,b,c)=>{b.exports=a.x("os",()=>require("os"))},24361,(a,b,c)=>{b.exports=a.x("util",()=>require("util"))},14747,(a,b,c)=>{b.exports=a.x("path",()=>require("path"))},27699,(a,b,c)=>{b.exports=a.x("events",()=>require("events"))},59619,96221,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(3130);let e=(0,a.i(70106).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);function f({wordHtml:a,suggestions:f,selectedSuggestionIndex:g,onContentChange:h,onApplySuggestion:i,isLoading:j=!1}){let[k,l]=(0,c.useState)(a),m=(0,c.useRef)(null);(0,c.useEffect)(()=>{l(a)},[a]),(0,c.useEffect)(()=>{if(null!==g&&m.current){let a=f[g];a&&n(a.original)}},[g,f]);let n=a=>{let b;if(!m.current)return;m.current.querySelectorAll(".suggestion-highlight").forEach(a=>{let b=a.parentNode;b&&(b.replaceChild(document.createTextNode(a.textContent||""),a),b.normalize())});let c=document.createTreeWalker(m.current,NodeFilter.SHOW_TEXT,null),d=[];for(;b=c.nextNode();)d.push(b);let e=a.toLowerCase(),f="",g=[];d.forEach(a=>{let b=f.length,c=a.textContent||"",d=(f+=c).length;g.push({start:b,end:d,node:a})});let h=f.toLowerCase().indexOf(e);if(-1!==h){let a=h+e.length;g.forEach(({start:b,end:c,node:d})=>{if(b>=a||c<=h)return;let e=d.textContent||"",f=Math.max(0,h-b),g=Math.min(e.length,a-b);if(f<g){let a=e.substring(0,f),b=e.substring(f,g),c=e.substring(g),h=document.createDocumentFragment();a&&h.appendChild(document.createTextNode(a));let i=document.createElement("mark");i.className="suggestion-highlight bg-yellow-200 dark:bg-yellow-300/40 px-1 rounded",i.textContent=b,h.appendChild(i),c&&h.appendChild(document.createTextNode(c)),d.parentNode?.replaceChild(h,d)}}),setTimeout(()=>{let a=m.current?.querySelector(".suggestion-highlight");a&&a.scrollIntoView({behavior:"smooth",block:"center"})},100)}};return(0,b.jsx)(d.Card,{className:"border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900",children:(0,b.jsx)(d.CardContent,{className:"p-0",children:j?(0,b.jsxs)("div",{className:"flex items-center justify-center h-[75vh]",children:[(0,b.jsx)(e,{className:"h-8 w-8 animate-spin text-zinc-500"}),(0,b.jsx)("span",{className:"ml-2 text-zinc-600 dark:text-zinc-400",children:"Processing document..."})]}):(0,b.jsx)("div",{ref:m,contentEditable:!0,suppressContentEditableWarning:!0,className:"prose prose-zinc dark:prose-invert max-w-none min-h-[75vh] max-h-[75vh] overflow-y-auto p-6 bg-white dark:bg-zinc-900 focus:outline-none focus:ring-2 focus:ring-emerald-500 rounded-md",dangerouslySetInnerHTML:{__html:k},onInput:a=>{let b=a.target.innerHTML;l(b),h(b)},style:{color:"inherit"}})})})}a.s(["Loader2",()=>e],96221),a.s(["default",()=>f],59619)},43602,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(46271),e=a.i(50944),f=a.i(73320),g=a.i(51168);let h=(0,a.i(70106).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var i=a.i(4720),j=a.i(3130),k=a.i(54161),l=a.i(40695),m=a.i(7379);let n=({suggestions:a,onSuggestionClick:c,selectedSuggestion:d,onApplySuggestion:e})=>(0,b.jsxs)(j.Card,{className:"border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900 sticky top-24",children:[(0,b.jsx)(j.CardHeader,{className:"pb-3",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(j.CardTitle,{className:"text-emerald-600 dark:text-emerald-400",children:"AI Suggestions"}),(0,b.jsx)(k.Badge,{variant:"secondary",className:"rounded-full",children:a.length})]})}),(0,b.jsx)(j.CardContent,{children:(0,b.jsx)("div",{className:"max-h-[calc(100vh-12rem)] overflow-y-auto space-y-3",children:0===a.length?(0,b.jsxs)("div",{className:"p-6 text-center flex flex-col items-center gap-4",children:[(0,b.jsx)(h,{className:"w-12 h-12 text-green-500"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-gray-900 dark:text-gray-50",children:"No suggestions found!"}),(0,b.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"The document looks great from a grammatical standpoint."})]})]}):a.map((a,f)=>(0,b.jsxs)("div",{onClick:()=>c(a),className:`rounded-md border p-3 cursor-pointer transition-colors ${d===a?"border-emerald-400 bg-emerald-50/50 dark:bg-emerald-900/20":"border-zinc-200 dark:border-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-800/50"}`,children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,b.jsxs)(k.Badge,{variant:"secondary",className:"rounded-full",children:[(0,b.jsx)(i.FileText,{className:"w-3 h-3 mr-1"}),"Page ",a.page]})}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Original:"}),(0,b.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300 line-through",children:a.original})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Suggestion:"}),(0,b.jsx)("p",{className:"text-sm text-green-600 dark:text-green-400 font-medium",children:a.suggestion})]}),a.explanation&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Reason:"}),(0,b.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 italic",children:a.explanation})]})]}),e&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(m.Separator,{className:"my-3"}),(0,b.jsx)(l.Button,{size:"sm",className:"w-full",onClick:a=>{a.stopPropagation(),e(f)},children:"Apply Change"})]})]},f))})})]});var o=a.i(92475),p=a.i(59619),q=a.i(49199),r=a.i(5522),s=a.i(17171),t=a.i(65602),u=a.i(2150);async function v(){return await a.A(61751)}a.s(["default",0,()=>{(0,e.useRouter)();let[a,h]=(0,c.useState)(null),[i,k]=(0,c.useState)(!1),[m,w]=(0,c.useState)(null),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)(66),[F,G]=(0,c.useState)(""),[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)(null);c.default.useEffect(()=>()=>{H&&URL.revokeObjectURL(H)},[H]);let L=async b=>{if(b.preventDefault(),!a)return void w("Please select a document to upload.");k(!0),w(null),y([]),C(null),E(12);try{let b=a.name.toLowerCase(),c=b.endsWith(".pdf")||"application/pdf"===a.type,d=b.endsWith(".docx")||a.type.includes("officedocument.wordprocessingml");if(c){let b=await a.arrayBuffer(),c=await v(),d=await c.getDocument({data:b}).promise,e="",f=new Blob([b],{type:"application/pdf"}),h=URL.createObjectURL(f);I(h),K("pdf");for(let a=1;a<=d.numPages;a++){let b=await d.getPage(a),c=(await b.getTextContent()).items.map(a=>a.str).join(" ");e+=`--- PAGE ${a} ---
${c}
`,E(Math.min(90,Math.round(a/d.numPages*80)+10))}A(e),E(92);let i=await (0,g.analyzePdfContent)(e);y(i),E(100)}else if(d){let b=await a.arrayBuffer(),c=(await q.default.convertToHtml({arrayBuffer:b})).value||"";G(c),K("docx"),E(82);let d=document.createElement("div");d.innerHTML=c;let e=d.textContent||d.innerText||"",f=await fetch("/api/analyze/docx",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e})});if(!f.ok)throw Error(`Analyze error ${f.status}`);let g=await f.json(),h=Array.isArray(g.suggestions)?g.suggestions:[];y(h),E(100)}else throw Error("Unsupported file type. Please upload a PDF or DOCX.")}catch(a){console.error("Failed to process file or get suggestions:",a),w("Could not process the file or get suggestions. Ensure it's a valid PDF/DOCX and your API_KEY is set.")}finally{k(!1)}},M=(a,b,c)=>{A(d=>{let e=`--- PAGE ${a} ---
`,f=d.split(e);if(f.length>1){let a=f[0],d=f.slice(1).join(e).split(b);if(d.length>1)return a+e+(d[0]+c+d.slice(1).join(b))}return d}),y(c=>c.filter(c=>c.page!==a||c.original!==b)),C(null)};return i?(0,b.jsx)("div",{className:"flex flex-col items-center justify-center h-screen bg-zinc-50 dark:bg-zinc-950 text-center gap-4 px-6",children:(0,b.jsxs)(j.Card,{className:"w-full max-w-md border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900",children:[(0,b.jsx)(j.CardHeader,{children:(0,b.jsx)(j.CardTitle,{className:"text-gray-900 dark:text-gray-50",children:"Analyzing Document..."})}),(0,b.jsxs)(j.CardContent,{className:"space-y-4",children:[(0,b.jsx)(u.Progress,{value:D}),(0,b.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Please wait while our AI proofreads your document."})]})]})}):(0,b.jsx)(d.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"min-h-screen bg-zinc-50 dark:bg-zinc-950 p-4 sm:p-6 lg:p-8 flex items-center justify-center",children:(0,b.jsx)(j.Card,{className:"max-w-6xl w-full border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900",children:(0,b.jsxs)(j.CardContent,{className:"p-6 sm:p-8 flex flex-col md:flex-row gap-8",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-50 mb-7 text-center",children:"Document Proofreader"}),m&&(0,b.jsxs)(t.Alert,{variant:"destructive",className:"mb-6",children:[(0,b.jsx)(t.AlertTitle,{children:"Error"}),(0,b.jsx)(t.AlertDescription,{children:m})]}),J?"pdf"===J&&H?(0,b.jsx)(o.default,{pdfUrl:H,suggestions:x,selectedSuggestion:B,onSuggestionClick:C,onApplyEdit:M}):"docx"===J&&F?(0,b.jsx)(p.default,{wordHtml:F,suggestions:x,onContentChange:G,onApplySuggestion:a=>{let b=x[a];if(!b)return;let c=RegExp(b.original.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"i");G(a=>a.replace(c,b.suggestion)),y(b=>b.filter((b,c)=>c!==a))}}):null:(0,b.jsx)("form",{onSubmit:L,className:"space-y-6 mb-8",children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{htmlFor:"file-upload",children:"Upload Document"}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(r.Input,{id:"file-upload",name:"file-upload",type:"file",accept:".pdf,.docx,application/pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document",onChange:a=>{H&&URL.revokeObjectURL(H),h(a.target.files?a.target.files[0]:null),y([]),w(null),A(""),G(""),I(null),K(null)}}),(0,b.jsxs)(l.Button,{type:"submit",children:[(0,b.jsx)(f.Upload,{className:"h-4 w-4 mr-2"}),"Analyze"]})]}),(0,b.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"PDF or DOCX, up to 10MB"}),a&&(0,b.jsx)("p",{className:"text-sm text-green-600 dark:text-green-400",children:a.name})]})})]}),(0,b.jsx)("div",{className:"md:w-1/3",children:(0,b.jsx)(n,{suggestions:x,onSuggestionClick:C,selectedSuggestion:B,onApplySuggestion:a=>{let b=x[a];b&&M(b.page,b.original,b.suggestion)}})})]})})})}],43602)},61751,a=>{a.v(b=>Promise.all(["server/chunks/ssr/node_modules_pdfjs-dist_build_pdf_mjs_74288fa9._.js"].map(b=>a.l(b))).then(()=>b(68062)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__1e7bac88._.js.map