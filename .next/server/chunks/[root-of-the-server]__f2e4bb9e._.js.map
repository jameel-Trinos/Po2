{"version":3,"sources":["turbopack:///[project]/node_modules/base64-js/index.js","turbopack:///[project]/lib/services/pdfWordConverter.ts","turbopack:///[project]/node_modules/next/dist/esm/build/templates/app-route.js","turbopack:///[project]/app/api/export/pdf/route.ts"],"sourcesContent":["'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","import mammoth from 'mammoth';\nimport { \n  Document, \n  Packer, \n  Paragraph, \n  TextRun, \n  HeadingLevel, \n  AlignmentType,\n  Table,\n  TableRow,\n  TableCell,\n  WidthType,\n  BorderStyle,\n  ImageRun,\n  UnderlineType\n} from 'docx';\nimport { PDFDocument, rgb, StandardFonts } from 'pdf-lib';\nimport type { Suggestion } from '../types/proofreader';\n\n// Helper function to load pdfjs dynamically\nasync function loadPdfJs() {\n  const pdfjs = await import('pdfjs-dist');\n  if (typeof window !== 'undefined' && !pdfjs.GlobalWorkerOptions.workerSrc) {\n    pdfjs.GlobalWorkerOptions.workerSrc = `//unpkg.com/pdfjs-dist@${pdfjs.version}/build/pdf.worker.min.mjs`;\n  }\n  return pdfjs;\n}\n\n/**\n * Sanitize text to replace Unicode characters that can't be encoded in WinAnsi\n * with ASCII equivalents\n */\nfunction sanitizeTextForPdf(text: string): string {\n  // Map of common Unicode characters to ASCII equivalents\n  const unicodeMap: Record<string, string> = {\n    '→': '->',\n    '←': '<-',\n    '↑': '^',\n    '↓': 'v',\n    '⇒': '=>',\n    '⇐': '<=',\n    '•': '*',\n    '–': '-',\n    '—': '--',\n    '…': '...',\n    '\\u201C': '\"',\n    '\\u201D': '\"',\n    '\\u2018': \"'\",\n    '\\u2019': \"'\",\n    '©': '(c)',\n    '®': '(R)',\n    '™': '(TM)',\n    '€': 'EUR',\n    '£': 'GBP',\n    '¥': 'JPY',\n  };\n\n  let sanitized = text;\n  \n  // Replace known Unicode characters\n  Object.entries(unicodeMap).forEach(([unicode, ascii]) => {\n    sanitized = sanitized.replace(new RegExp(unicode, 'g'), ascii);\n  });\n\n  // Remove any remaining non-ASCII characters that can't be encoded\n  // This regex keeps ASCII printable characters (32-126) and common whitespace (excluding newlines as they're handled separately)\n  sanitized = sanitized.replace(/[^\\x20-\\x7E\\n\\r\\t]/g, '?');\n\n  return sanitized;\n}\n\n/**\n * Convert PDF to HTML for rich text editing\n * Uses pdfjs-dist to extract text with layout preservation\n */\nexport async function convertPdfToHtml(pdfUrl: string): Promise<string> {\n  try {\n    // Dynamically load pdfjs\n    const pdfjs = await loadPdfJs();\n\n    // Load PDF bytes\n    let pdfBytes: ArrayBuffer;\n    \n    if (pdfUrl.startsWith('data:')) {\n      const base64Data = pdfUrl.split(',')[1];\n      const binaryString = atob(base64Data);\n      const bytes = new Uint8Array(binaryString.length);\n      for (let i = 0; i < binaryString.length; i++) {\n        bytes[i] = binaryString.charCodeAt(i);\n      }\n      pdfBytes = bytes.buffer;\n    } else {\n      const response = await fetch(pdfUrl);\n      pdfBytes = await response.arrayBuffer();\n    }\n\n    const pdf = await pdfjs.getDocument({ data: pdfBytes }).promise;\n    const htmlParts: string[] = [];\n\n    for (let pageNum = 1; pageNum <= pdf.numPages; pageNum++) {\n      try {\n        const page = await pdf.getPage(pageNum);\n        const textContent = await page.getTextContent();\n        \n        // Group text items into paragraphs based on vertical position\n        const lines: { y: number; items: any[] }[] = [];\n        let currentLine: { y: number; items: any[] } | null = null;\n        \n        textContent.items.forEach((item: any) => {\n          const y = item.transform[5];\n          \n          if (!currentLine || Math.abs(currentLine.y - y) > 5) {\n            currentLine = { y, items: [item] };\n            lines.push(currentLine);\n          } else {\n            currentLine.items.push(item);\n          }\n        });\n\n        // Convert lines to HTML paragraphs\n        lines.forEach(line => {\n          const text = line.items.map((item: any) => item.str).join(' ').trim();\n          if (text) {\n            // Detect if it might be a heading (simple heuristic: short lines with larger font)\n            const avgFontSize = line.items.reduce((sum: number, item: any) => \n              sum + (item.height || 12), 0) / line.items.length;\n            \n            if (avgFontSize > 16 && text.length < 100) {\n              htmlParts.push(`<h2>${text}</h2>`);\n            } else {\n              htmlParts.push(`<p>${text}</p>`);\n            }\n          }\n        });\n      } catch (err: any) {\n        // Silently ignore abort/cancellation errors\n        if (err?.name === 'AbortError' || err?.name === 'AbortException' || \n            err?.message?.includes('cancelled') || err?.message?.includes('abort')) {\n          continue;\n        }\n        throw err;\n      }\n    }\n\n    return htmlParts.join('\\n');\n  } catch (error) {\n    console.error('Error converting PDF to HTML:', error);\n    throw new Error('Failed to convert PDF to HTML');\n  }\n}\n\n/**\n * Draw HTML table in PDF\n */\nasync function drawTableInPdf(\n  tableElement: HTMLTableElement,\n  pdfDoc: PDFDocument,\n  currentPage: any,\n  yPosition: number,\n  font: any,\n  boldFont: any,\n  margin: number\n): Promise<{ page: any; yPosition: number }> {\n  const cellPadding = 5;\n  const cellHeight = 25;\n  const pageWidth = 612;\n  const maxWidth = pageWidth - (margin * 2);\n  \n  // Get all rows\n  const allRows = Array.from(tableElement.querySelectorAll('tr'));\n  const numCols = Math.max(...allRows.map(row => row.querySelectorAll('td, th').length));\n  const colWidth = maxWidth / numCols;\n  \n  let page = currentPage;\n  let y = yPosition;\n  \n  for (const row of allRows) {\n    // Check if we need a new page\n    if (y < 50) {\n      page = pdfDoc.addPage([612, 792]);\n      y = 750;\n    }\n    \n    const cells = Array.from(row.querySelectorAll('td, th'));\n    const isHeader = cells[0]?.tagName === 'TH';\n    \n    // Draw cell backgrounds for headers\n    if (isHeader) {\n      page.drawRectangle({\n        x: margin,\n        y: y - cellHeight,\n        width: maxWidth,\n        height: cellHeight,\n        color: rgb(0.9, 0.9, 0.9),\n      });\n    }\n    \n    // Draw cell borders and content\n    cells.forEach((cell, colIndex) => {\n      const x = margin + (colIndex * colWidth);\n      \n      // Draw cell border\n      page.drawRectangle({\n        x,\n        y: y - cellHeight,\n        width: colWidth,\n        height: cellHeight,\n        borderColor: rgb(0, 0, 0),\n        borderWidth: 1,\n      });\n      \n      // Draw cell text\n      let text = cell.textContent?.trim() || '';\n      text = sanitizeTextForPdf(text);\n      \n      // Truncate text if too long\n      const maxTextWidth = colWidth - (cellPadding * 2);\n      const currentFont = isHeader ? boldFont : font;\n      const fontSize = 10;\n      \n      while (currentFont.widthOfTextAtSize(text, fontSize) > maxTextWidth && text.length > 0) {\n        text = text.slice(0, -4) + '...';\n      }\n      \n      page.drawText(text, {\n        x: x + cellPadding,\n        y: y - cellHeight + cellPadding + 5,\n        size: fontSize,\n        font: currentFont,\n        color: rgb(0, 0, 0),\n      });\n    });\n    \n    y -= cellHeight;\n  }\n  \n  return { page, yPosition: y - 10 }; // Add extra spacing after table\n}\n\n/**\n * Embed image in PDF\n */\nasync function embedImageInPdf(\n  imgElement: HTMLImageElement,\n  pdfDoc: PDFDocument,\n  currentPage: any,\n  yPosition: number,\n  margin: number\n): Promise<{ page: any; yPosition: number }> {\n  try {\n    let src = imgElement.src;\n    \n    if (!src.startsWith('data:') && !src.startsWith('http')) {\n      console.warn('Cannot embed relative URL images in PDF:', src);\n      return { page: currentPage, yPosition };\n    }\n    \n    // Fetch image data\n    let imageBytes: Uint8Array;\n    let imageType: 'png' | 'jpg';\n    \n    if (src.startsWith('data:')) {\n      const base64Data = src.split(',')[1];\n      const mimeType = src.split(';')[0].split(':')[1];\n      imageType = mimeType.includes('png') ? 'png' : 'jpg';\n      \n      const binaryString = atob(base64Data);\n      imageBytes = new Uint8Array(binaryString.length);\n      for (let i = 0; i < binaryString.length; i++) {\n        imageBytes[i] = binaryString.charCodeAt(i);\n      }\n    } else {\n      const response = await fetch(src);\n      const arrayBuffer = await response.arrayBuffer();\n      imageBytes = new Uint8Array(arrayBuffer);\n      imageType = src.toLowerCase().endsWith('.png') ? 'png' : 'jpg';\n    }\n    \n    // Embed image\n    const image = imageType === 'png' \n      ? await pdfDoc.embedPng(imageBytes)\n      : await pdfDoc.embedJpg(imageBytes);\n    \n    const imgDims = image.scale(0.5); // Scale down by 50%\n    const maxWidth = 512;\n    const maxHeight = 400;\n    \n    let width = imgDims.width;\n    let height = imgDims.height;\n    \n    // Scale to fit within max dimensions\n    if (width > maxWidth) {\n      height = (height * maxWidth) / width;\n      width = maxWidth;\n    }\n    if (height > maxHeight) {\n      width = (width * maxHeight) / height;\n      height = maxHeight;\n    }\n    \n    // Check if we need a new page\n    let page = currentPage;\n    let y = yPosition;\n    \n    if (y - height < 50) {\n      page = pdfDoc.addPage([612, 792]);\n      y = 750;\n    }\n    \n    // Draw image\n    page.drawImage(image, {\n      x: margin,\n      y: y - height,\n      width,\n      height,\n    });\n    \n    return { page, yPosition: y - height - 10 };\n  } catch (error) {\n    console.error('Error embedding image in PDF:', error);\n    return { page: currentPage, yPosition };\n  }\n}\n\n/**\n * Convert HTML from rich text editor to PDF with full formatting\n */\nexport async function convertHtmlToPdf(html: string): Promise<string> {\n  try {\n    const pdfDoc = await PDFDocument.create();\n    const font = await pdfDoc.embedFont(StandardFonts.Helvetica);\n    const boldFont = await pdfDoc.embedFont(StandardFonts.HelveticaBold);\n    \n    let currentPage = pdfDoc.addPage([612, 792]); // US Letter size\n    let yPosition = 750;\n    const lineHeight = 18;\n    const margin = 50;\n    const maxWidth = 512;\n\n    // Parse HTML into structured content\n    const parser = new DOMParser();\n    const doc = parser.parseFromString(html, 'text/html');\n    const elements = doc.body.children;\n\n    for (let i = 0; i < elements.length; i++) {\n      const element = elements[i];\n      const tagName = element.tagName.toLowerCase();\n      \n      // Handle tables\n      if (tagName === 'table') {\n        const result = await drawTableInPdf(\n          element as HTMLTableElement,\n          pdfDoc,\n          currentPage,\n          yPosition,\n          font,\n          boldFont,\n          margin\n        );\n        currentPage = result.page;\n        yPosition = result.yPosition;\n        continue;\n      }\n      \n      // Handle images\n      if (tagName === 'img') {\n        const result = await embedImageInPdf(\n          element as HTMLImageElement,\n          pdfDoc,\n          currentPage,\n          yPosition,\n          margin\n        );\n        currentPage = result.page;\n        yPosition = result.yPosition;\n        continue;\n      }\n      \n      // Handle lists\n      if (tagName === 'ul' || tagName === 'ol') {\n        const listItems = Array.from(element.querySelectorAll('li'));\n        listItems.forEach((li, index) => {\n          const bulletText = tagName === 'ul' ? '• ' : `${index + 1}. `;\n          let text = li.textContent?.trim() || '';\n          text = sanitizeTextForPdf(bulletText + text);\n          \n          // Wrap text\n          const words = text.split(' ');\n          let currentLine = '';\n          \n          for (const word of words) {\n            const testLine = currentLine ? `${currentLine} ${word}` : word;\n            const textWidth = font.widthOfTextAtSize(testLine, 12);\n            \n            if (textWidth > maxWidth && currentLine) {\n              if (yPosition < 50) {\n                currentPage = pdfDoc.addPage([612, 792]);\n                yPosition = 750;\n              }\n              \n              currentPage.drawText(currentLine, {\n                x: margin + 20, // Indent list items\n                y: yPosition,\n                size: 12,\n                font: font,\n                color: rgb(0, 0, 0),\n              });\n              \n              yPosition -= lineHeight;\n              currentLine = word;\n            } else {\n              currentLine = testLine;\n            }\n          }\n          \n          if (currentLine) {\n            if (yPosition < 50) {\n              currentPage = pdfDoc.addPage([612, 792]);\n              yPosition = 750;\n            }\n            \n            currentPage.drawText(currentLine, {\n              x: margin + 20,\n              y: yPosition,\n              size: 12,\n              font: font,\n              color: rgb(0, 0, 0),\n            });\n            \n            yPosition -= lineHeight;\n          }\n        });\n        continue;\n      }\n      \n      // Handle regular text elements\n      let text = element.textContent?.trim() || '';\n      if (!text) continue;\n\n      // Sanitize text for PDF encoding\n      text = sanitizeTextForPdf(text);\n\n      // Determine font size and style based on element type\n      let fontSize = 12;\n      let currentFont = font;\n      let spacing = lineHeight;\n\n      if (tagName.startsWith('h')) {\n        const level = parseInt(tagName[1]);\n        fontSize = 24 - (level * 2);\n        currentFont = boldFont;\n        spacing = lineHeight * 1.5;\n      } else if (tagName === 'strong' || tagName === 'b') {\n        currentFont = boldFont;\n      }\n\n      // Split text by newlines first to handle line breaks properly\n      const lines = text.split(/\\r?\\n/);\n      \n      for (const line of lines) {\n        // Wrap text to fit within page width\n        const words = line.split(' ');\n        let currentLine = '';\n\n        for (const word of words) {\n          const testLine = currentLine ? `${currentLine} ${word}` : word;\n          const textWidth = currentFont.widthOfTextAtSize(testLine, fontSize);\n\n          if (textWidth > maxWidth && currentLine) {\n            // Draw current line\n            if (yPosition < 50) {\n              currentPage = pdfDoc.addPage([612, 792]);\n              yPosition = 750;\n            }\n\n            currentPage.drawText(currentLine, {\n              x: margin,\n              y: yPosition,\n              size: fontSize,\n              font: currentFont,\n              color: rgb(0, 0, 0),\n            });\n\n            yPosition -= spacing;\n            currentLine = word;\n          } else {\n            currentLine = testLine;\n          }\n        }\n\n        // Draw remaining text\n        if (currentLine) {\n          if (yPosition < 50) {\n            currentPage = pdfDoc.addPage([612, 792]);\n            yPosition = 750;\n          }\n\n          currentPage.drawText(currentLine, {\n            x: margin,\n            y: yPosition,\n            size: fontSize,\n            font: currentFont,\n            color: rgb(0, 0, 0),\n          });\n\n          yPosition -= spacing;\n        } else if (line === '') {\n          // Handle empty lines (preserve blank lines)\n          yPosition -= spacing;\n        }\n      }\n\n      // Add extra spacing after headings\n      if (tagName.startsWith('h')) {\n        yPosition -= lineHeight * 0.5;\n      }\n    }\n\n    const pdfBytes = await pdfDoc.save();\n    const base64 = btoa(String.fromCharCode(...pdfBytes));\n    return `data:application/pdf;base64,${base64}`;\n  } catch (error) {\n    console.error('Error converting HTML to PDF:', error);\n    throw new Error('Failed to convert HTML to PDF');\n  }\n}\n\n/**\n * Convert Word document to PDF (legacy compatibility)\n */\nexport async function convertWordToPdf(wordBlob: Blob): Promise<string> {\n  try {\n    const html = await wordBlobToHtml(wordBlob);\n    return await convertHtmlToPdf(html);\n  } catch (error) {\n    console.error('Error converting Word to PDF:', error);\n    throw new Error('Failed to convert Word document to PDF');\n  }\n}\n\n/**\n * Apply suggestions to Word document content\n */\nexport function applySuggestionsToWordContent(\n  wordContent: string,\n  suggestions: Suggestion[]\n): string {\n  let modifiedContent = wordContent;\n  \n  suggestions.forEach(suggestion => {\n    // Replace original text with suggestion\n    const originalText = suggestion.original || suggestion.text;\n    const regex = new RegExp(originalText.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'), 'gi');\n    modifiedContent = modifiedContent.replace(regex, suggestion.suggestion);\n  });\n  \n  return modifiedContent;\n}\n\n/**\n * Convert Word Blob to HTML string for editing\n */\nexport async function wordBlobToHtml(wordBlob: Blob): Promise<string> {\n  try {\n    const arrayBuffer = await wordBlob.arrayBuffer();\n    const result = await mammoth.convertToHtml({ arrayBuffer });\n    return result.value;\n  } catch (error) {\n    console.error('Error converting Word to HTML:', error);\n    throw new Error('Failed to convert Word document to HTML');\n  }\n}\n\n/**\n * Parse inline styles and return text run options\n */\nfunction parseTextRunStyles(element: Element): any {\n  const style = element.getAttribute('style') || '';\n  const computedStyle = window.getComputedStyle(element);\n  const options: any = {};\n\n  // Bold\n  if (element.tagName === 'STRONG' || element.tagName === 'B' || \n      computedStyle.fontWeight === 'bold' || parseInt(computedStyle.fontWeight) >= 700) {\n    options.bold = true;\n  }\n\n  // Italic\n  if (element.tagName === 'EM' || element.tagName === 'I' || \n      computedStyle.fontStyle === 'italic') {\n    options.italics = true;\n  }\n\n  // Underline\n  if (element.tagName === 'U' || computedStyle.textDecoration.includes('underline')) {\n    options.underline = { type: UnderlineType.SINGLE };\n  }\n\n  // Font size (convert from px to points - 12pt = 16px)\n  const fontSize = parseInt(computedStyle.fontSize);\n  if (fontSize && fontSize > 0) {\n    options.size = Math.round((fontSize * 72) / 96); // Convert pixels to points\n  }\n\n  return options;\n}\n\n/**\n * Process text node with inline formatting\n */\nfunction processTextNode(node: Node, parentElement: Element): TextRun[] {\n  const runs: TextRun[] = [];\n  \n  if (node.nodeType === Node.TEXT_NODE) {\n    const text = node.textContent || '';\n    if (text.trim()) {\n      const styles = parseTextRunStyles(parentElement);\n      runs.push(new TextRun({ text, ...styles }));\n    }\n  } else if (node.nodeType === Node.ELEMENT_NODE) {\n    const element = node as Element;\n    const styles = parseTextRunStyles(element);\n    \n    // Process child nodes recursively\n    Array.from(element.childNodes).forEach(child => {\n      if (child.nodeType === Node.TEXT_NODE) {\n        const text = child.textContent || '';\n        if (text.trim()) {\n          runs.push(new TextRun({ text, ...styles }));\n        }\n      } else {\n        runs.push(...processTextNode(child, element));\n      }\n    });\n  }\n  \n  return runs;\n}\n\n/**\n * Convert HTML table to Word Table\n */\nasync function htmlTableToWordTable(tableElement: HTMLTableElement): Promise<Table> {\n  const rows: TableRow[] = [];\n  \n  // Process all rows (including thead and tbody)\n  const allRows = Array.from(tableElement.querySelectorAll('tr'));\n  \n  for (const row of allRows) {\n    const cells: TableCell[] = [];\n    const cellElements = Array.from(row.querySelectorAll('td, th'));\n    \n    for (const cell of cellElements) {\n      const isHeader = cell.tagName === 'TH';\n      const textRuns: TextRun[] = [];\n      \n      // Get cell text with formatting\n      Array.from(cell.childNodes).forEach(node => {\n        const runs = processTextNode(node, cell);\n        textRuns.push(...runs);\n      });\n      \n      // If no formatted text, just get plain text\n      if (textRuns.length === 0) {\n        const text = cell.textContent?.trim() || '';\n        textRuns.push(new TextRun({ \n          text, \n          bold: isHeader \n        }));\n      }\n      \n      cells.push(\n        new TableCell({\n          children: [new Paragraph({ children: textRuns })],\n          shading: isHeader ? {\n            fill: 'E7E7E7', // Light gray for headers\n          } : undefined,\n        })\n      );\n    }\n    \n    rows.push(new TableRow({ children: cells }));\n  }\n  \n  return new Table({\n    rows,\n    width: {\n      size: 100,\n      type: WidthType.PERCENTAGE,\n    },\n    borders: {\n      top: { style: BorderStyle.SINGLE, size: 1 },\n      bottom: { style: BorderStyle.SINGLE, size: 1 },\n      left: { style: BorderStyle.SINGLE, size: 1 },\n      right: { style: BorderStyle.SINGLE, size: 1 },\n      insideHorizontal: { style: BorderStyle.SINGLE, size: 1 },\n      insideVertical: { style: BorderStyle.SINGLE, size: 1 },\n    },\n  });\n}\n\n/**\n * Convert image to base64 and create ImageRun\n */\nasync function htmlImageToWordImage(imgElement: HTMLImageElement): Promise<ImageRun | null> {\n  try {\n    // Get image source\n    let src = imgElement.src;\n    \n    // If it's a relative URL, we can't load it in the browser context\n    if (!src.startsWith('data:') && !src.startsWith('http')) {\n      console.warn('Cannot embed relative URL images:', src);\n      return null;\n    }\n    \n    // Fetch image as blob\n    let imageBytes: Uint8Array;\n    \n    if (src.startsWith('data:')) {\n      // Extract base64 data\n      const base64Data = src.split(',')[1];\n      const binaryString = atob(base64Data);\n      imageBytes = new Uint8Array(binaryString.length);\n      for (let i = 0; i < binaryString.length; i++) {\n        imageBytes[i] = binaryString.charCodeAt(i);\n      }\n    } else {\n      // Fetch from URL\n      const response = await fetch(src);\n      const arrayBuffer = await response.arrayBuffer();\n      imageBytes = new Uint8Array(arrayBuffer);\n    }\n    \n    // Get image dimensions\n    const width = imgElement.width || 400;\n    const height = imgElement.height || 300;\n    \n    // Determine image type from src\n    const imageType = src.toLowerCase().includes('png') ? 'png' : 'jpg';\n    \n    return new ImageRun({\n      data: imageBytes,\n      type: imageType,\n      transformation: {\n        width: Math.min(width, 600), // Max width 600px\n        height: Math.min(height, 450), // Max height 450px\n      },\n    }) as any;\n  } catch (error) {\n    console.error('Error embedding image:', error);\n    return null;\n  }\n}\n\n/**\n * Process HTML element and convert to Word elements\n */\nasync function processHtmlElement(element: Element): Promise<any[]> {\n  const wordElements: any[] = [];\n  const tagName = element.tagName.toLowerCase();\n  \n  // Handle tables\n  if (tagName === 'table') {\n    const table = await htmlTableToWordTable(element as HTMLTableElement);\n    wordElements.push(table);\n    return wordElements;\n  }\n  \n  // Handle images\n  if (tagName === 'img') {\n    const imageRun = await htmlImageToWordImage(element as HTMLImageElement);\n    if (imageRun) {\n      wordElements.push(new Paragraph({ children: [imageRun] }));\n    }\n    return wordElements;\n  }\n  \n  // Handle lists\n  if (tagName === 'ul' || tagName === 'ol') {\n    const listItems = Array.from(element.querySelectorAll('li'));\n    listItems.forEach((li, index) => {\n      const textRuns: TextRun[] = [];\n      Array.from(li.childNodes).forEach(node => {\n        const runs = processTextNode(node, li);\n        textRuns.push(...runs);\n      });\n      \n      if (textRuns.length === 0) {\n        const text = li.textContent?.trim() || '';\n        textRuns.push(new TextRun({ text }));\n      }\n      \n      const bulletText = tagName === 'ul' ? '• ' : `${index + 1}. `;\n      textRuns.unshift(new TextRun({ text: bulletText }));\n      \n      wordElements.push(new Paragraph({ children: textRuns }));\n    });\n    return wordElements;\n  }\n  \n  // Handle regular paragraphs and headings\n  const text = element.textContent?.trim() || '';\n  if (!text && tagName !== 'br') return wordElements;\n  \n  // Create paragraph options\n  const paragraphOptions: any = { children: [] };\n  \n  // Handle headings\n  if (tagName === 'h1') {\n    paragraphOptions.heading = HeadingLevel.HEADING_1;\n  } else if (tagName === 'h2') {\n    paragraphOptions.heading = HeadingLevel.HEADING_2;\n  } else if (tagName === 'h3') {\n    paragraphOptions.heading = HeadingLevel.HEADING_3;\n  } else if (tagName === 'h4') {\n    paragraphOptions.heading = HeadingLevel.HEADING_4;\n  }\n  \n  // Handle text alignment\n  const style = element.getAttribute('style') || '';\n  const computedStyle = window.getComputedStyle(element);\n  const textAlign = computedStyle.textAlign;\n  \n  if (textAlign === 'center' || style.includes('text-align: center')) {\n    paragraphOptions.alignment = AlignmentType.CENTER;\n  } else if (textAlign === 'right' || style.includes('text-align: right')) {\n    paragraphOptions.alignment = AlignmentType.RIGHT;\n  } else if (textAlign === 'justify' || style.includes('text-align: justify')) {\n    paragraphOptions.alignment = AlignmentType.JUSTIFIED;\n  }\n  \n  // Process text with inline formatting\n  const textRuns: TextRun[] = [];\n  Array.from(element.childNodes).forEach(node => {\n    const runs = processTextNode(node, element);\n    textRuns.push(...runs);\n  });\n  \n  // If no formatted text, just use plain text\n  if (textRuns.length === 0 && text) {\n    textRuns.push(new TextRun({ text }));\n  }\n  \n  if (textRuns.length > 0) {\n    paragraphOptions.children = textRuns;\n    wordElements.push(new Paragraph(paragraphOptions));\n  }\n  \n  return wordElements;\n}\n\n/**\n * Convert HTML string to Word Blob with full formatting preservation\n */\nexport async function htmlToWordBlob(htmlContent: string): Promise<Blob> {\n  try {\n    const parser = new DOMParser();\n    const doc = parser.parseFromString(htmlContent, 'text/html');\n    const wordElements: any[] = [];\n    \n    // Process each top-level element in the HTML body\n    const elements = Array.from(doc.body.children);\n    \n    for (const element of elements) {\n      const processed = await processHtmlElement(element);\n      wordElements.push(...processed);\n    }\n    \n    // Create Word document with processed elements\n    const wordDoc = new Document({\n      sections: [\n        {\n          properties: {\n            page: {\n              margin: {\n                top: 1440, // 1 inch = 1440 twentieths of a point\n                right: 1440,\n                bottom: 1440,\n                left: 1440,\n              },\n            },\n          },\n          children: wordElements.length > 0 ? wordElements : [\n            new Paragraph({\n              children: [new TextRun({ text: '' })],\n            }),\n          ],\n        },\n      ],\n    });\n\n    return await Packer.toBlob(wordDoc);\n  } catch (error) {\n    console.error('Error converting HTML to Word:', error);\n    throw new Error('Failed to convert HTML to Word document');\n  }\n}\n\n\n","import { AppRouteRouteModule } from \"next/dist/esm/server/route-modules/app-route/module.compiled\";\nimport { RouteKind } from \"next/dist/esm/server/route-kind\";\nimport { patchFetch as _patchFetch } from \"next/dist/esm/server/lib/patch-fetch\";\nimport { addRequestMeta, getRequestMeta } from \"next/dist/esm/server/request-meta\";\nimport { getTracer, SpanKind } from \"next/dist/esm/server/lib/trace/tracer\";\nimport { setReferenceManifestsSingleton } from \"next/dist/esm/server/app-render/encryption-utils\";\nimport { createServerModuleMap } from \"next/dist/esm/server/app-render/action-utils\";\nimport { normalizeAppPath } from \"next/dist/esm/shared/lib/router/utils/app-paths\";\nimport { NodeNextRequest, NodeNextResponse } from \"next/dist/esm/server/base-http/node\";\nimport { NextRequestAdapter, signalFromNodeResponse } from \"next/dist/esm/server/web/spec-extension/adapters/next-request\";\nimport { BaseServerSpan } from \"next/dist/esm/server/lib/trace/constants\";\nimport { getRevalidateReason } from \"next/dist/esm/server/instrumentation/utils\";\nimport { sendResponse } from \"next/dist/esm/server/send-response\";\nimport { fromNodeOutgoingHttpHeaders, toNodeOutgoingHttpHeaders } from \"next/dist/esm/server/web/utils\";\nimport { getCacheControlHeader } from \"next/dist/esm/server/lib/cache-control\";\nimport { INFINITE_CACHE, NEXT_CACHE_TAGS_HEADER } from \"next/dist/esm/lib/constants\";\nimport { NoFallbackError } from \"next/dist/esm/shared/lib/no-fallback-error.external\";\nimport { CachedRouteKind } from \"next/dist/esm/server/response-cache\";\nimport * as userland from \"INNER_APP_ROUTE\";\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new AppRouteRouteModule({\n    definition: {\n        kind: RouteKind.APP_ROUTE,\n        page: \"/api/export/pdf/route\",\n        pathname: \"/api/export/pdf\",\n        filename: \"route\",\n        bundlePath: \"\"\n    },\n    distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n    relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',\n    resolvedPagePath: \"[project]/app/api/export/pdf/route.ts\",\n    nextConfigOutput,\n    userland\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return _patchFetch({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\nexport { routeModule, workAsyncStorage, workUnitAsyncStorage, serverHooks, patchFetch,  };\nexport async function handler(req, res, ctx) {\n    if (routeModule.isDev) {\n        addRequestMeta(req, 'devRequestTimingInternalsEnd', process.hrtime.bigint());\n    }\n    let srcPage = \"/api/export/pdf/route\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (process.env.TURBOPACK) {\n        srcPage = srcPage.replace(/\\/index$/, '') || '/';\n    } else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = process.env.__NEXT_MULTI_ZONE_DRAFT_MODE;\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return null;\n    }\n    const { buildId, params, nextConfig, parsedUrl, isDraftMode, prerenderManifest, routerServerContext, isOnDemandRevalidate, revalidateOnlyGenerated, resolvedPathname, clientReferenceManifest, serverActionsManifest } = prepareResult;\n    const normalizedSrcPage = normalizeAppPath(srcPage);\n    let isIsr = Boolean(prerenderManifest.dynamicRoutes[normalizedSrcPage] || prerenderManifest.routes[resolvedPathname]);\n    const render404 = async ()=>{\n        // TODO: should route-module itself handle rendering the 404\n        if (routerServerContext == null ? void 0 : routerServerContext.render404) {\n            await routerServerContext.render404(req, res, parsedUrl, false);\n        } else {\n            res.end('This page could not be found');\n        }\n        return null;\n    };\n    if (isIsr && !isDraftMode) {\n        const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname]);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                if (nextConfig.experimental.adapterPath) {\n                    return await render404();\n                }\n                throw new NoFallbackError();\n            }\n        }\n    }\n    let cacheKey = null;\n    if (isIsr && !routeModule.isDev && !isDraftMode) {\n        cacheKey = resolvedPathname;\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    const supportsDynamicResponse = // If we're in development, we always support dynamic HTML\n    routeModule.isDev === true || // If this is not SSG or does not have static paths, then it supports\n    // dynamic HTML.\n    !isIsr;\n    // This is a revalidation request if the request is for a static\n    // page and it is not being resumed from a postponed render and\n    // it is not a dynamic RSC request then it is a revalidation\n    // request.\n    const isStaticGeneration = isIsr && !supportsDynamicResponse;\n    // Before rendering (which initializes component tree modules), we have to\n    // set the reference manifests to our global store so Server Action's\n    // encryption util can access to them at the top level of the page module.\n    if (serverActionsManifest && clientReferenceManifest) {\n        setReferenceManifestsSingleton({\n            page: srcPage,\n            clientReferenceManifest,\n            serverActionsManifest,\n            serverModuleMap: createServerModuleMap({\n                serverActionsManifest\n            })\n        });\n    }\n    const method = req.method || 'GET';\n    const tracer = getTracer();\n    const activeSpan = tracer.getActiveScopeSpan();\n    const context = {\n        params,\n        prerenderManifest,\n        renderOpts: {\n            experimental: {\n                authInterrupts: Boolean(nextConfig.experimental.authInterrupts)\n            },\n            cacheComponents: Boolean(nextConfig.cacheComponents),\n            supportsDynamicResponse,\n            incrementalCache: getRequestMeta(req, 'incrementalCache'),\n            cacheLifeProfiles: nextConfig.cacheLife,\n            waitUntil: ctx.waitUntil,\n            onClose: (cb)=>{\n                res.on('close', cb);\n            },\n            onAfterTaskError: undefined,\n            onInstrumentationRequestError: (error, _request, errorContext)=>routeModule.onRequestError(req, error, errorContext, routerServerContext)\n        },\n        sharedContext: {\n            buildId\n        }\n    };\n    const nodeNextReq = new NodeNextRequest(req);\n    const nodeNextRes = new NodeNextResponse(res);\n    const nextReq = NextRequestAdapter.fromNodeNextRequest(nodeNextReq, signalFromNodeResponse(res));\n    try {\n        const invokeRouteModule = async (span)=>{\n            return routeModule.handle(nextReq, context).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${srcPage}`);\n                }\n            });\n        };\n        const isMinimalMode = Boolean(process.env.MINIMAL_MODE || getRequestMeta(req, 'minimalMode'));\n        const handleResponse = async (currentSpan)=>{\n            var _cacheEntry_value;\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                try {\n                    if (!isMinimalMode && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                        res.statusCode = 404;\n                        // on-demand revalidate always sets this header\n                        res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                        res.end('This page could not be found');\n                        return null;\n                    }\n                    const response = await invokeRouteModule(currentSpan);\n                    req.fetchMetrics = context.renderOpts.fetchMetrics;\n                    let pendingWaitUntil = context.renderOpts.pendingWaitUntil;\n                    // Attempt using provided waitUntil if available\n                    // if it's not we fallback to sendResponse's handling\n                    if (pendingWaitUntil) {\n                        if (ctx.waitUntil) {\n                            ctx.waitUntil(pendingWaitUntil);\n                            pendingWaitUntil = undefined;\n                        }\n                    }\n                    const cacheTags = context.renderOpts.collectedTags;\n                    // If the request is for a static response, we can cache it so long\n                    // as it's not edge.\n                    if (isIsr) {\n                        const blob = await response.blob();\n                        // Copy the headers from the response.\n                        const headers = toNodeOutgoingHttpHeaders(response.headers);\n                        if (cacheTags) {\n                            headers[NEXT_CACHE_TAGS_HEADER] = cacheTags;\n                        }\n                        if (!headers['content-type'] && blob.type) {\n                            headers['content-type'] = blob.type;\n                        }\n                        const revalidate = typeof context.renderOpts.collectedRevalidate === 'undefined' || context.renderOpts.collectedRevalidate >= INFINITE_CACHE ? false : context.renderOpts.collectedRevalidate;\n                        const expire = typeof context.renderOpts.collectedExpire === 'undefined' || context.renderOpts.collectedExpire >= INFINITE_CACHE ? undefined : context.renderOpts.collectedExpire;\n                        // Create the cache entry for the response.\n                        const cacheEntry = {\n                            value: {\n                                kind: CachedRouteKind.APP_ROUTE,\n                                status: response.status,\n                                body: Buffer.from(await blob.arrayBuffer()),\n                                headers\n                            },\n                            cacheControl: {\n                                revalidate,\n                                expire\n                            }\n                        };\n                        return cacheEntry;\n                    } else {\n                        // send response without caching if not ISR\n                        await sendResponse(nodeNextReq, nodeNextRes, response, context.renderOpts.pendingWaitUntil);\n                        return null;\n                    }\n                } catch (err) {\n                    // if this is a background revalidate we need to report\n                    // the request error here as it won't be bubbled\n                    if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                        await routeModule.onRequestError(req, err, {\n                            routerKind: 'App Router',\n                            routePath: srcPage,\n                            routeType: 'route',\n                            revalidateReason: getRevalidateReason({\n                                isStaticGeneration,\n                                isOnDemandRevalidate\n                            })\n                        }, routerServerContext);\n                    }\n                    throw err;\n                }\n            };\n            const cacheEntry = await routeModule.handleResponse({\n                req,\n                nextConfig,\n                cacheKey,\n                routeKind: RouteKind.APP_ROUTE,\n                isFallback: false,\n                prerenderManifest,\n                isRoutePPREnabled: false,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                responseGenerator,\n                waitUntil: ctx.waitUntil,\n                isMinimalMode\n            });\n            // we don't create a cacheEntry for ISR\n            if (!isIsr) {\n                return null;\n            }\n            if ((cacheEntry == null ? void 0 : (_cacheEntry_value = cacheEntry.value) == null ? void 0 : _cacheEntry_value.kind) !== CachedRouteKind.APP_ROUTE) {\n                var _cacheEntry_value1;\n                throw Object.defineProperty(new Error(`Invariant: app-route received invalid cache entry ${cacheEntry == null ? void 0 : (_cacheEntry_value1 = cacheEntry.value) == null ? void 0 : _cacheEntry_value1.kind}`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E701\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            if (!isMinimalMode) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : cacheEntry.isMiss ? 'MISS' : cacheEntry.isStale ? 'STALE' : 'HIT');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            const headers = fromNodeOutgoingHttpHeaders(cacheEntry.value.headers);\n            if (!(isMinimalMode && isIsr)) {\n                headers.delete(NEXT_CACHE_TAGS_HEADER);\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheEntry.cacheControl && !res.getHeader('Cache-Control') && !headers.get('Cache-Control')) {\n                headers.set('Cache-Control', getCacheControlHeader(cacheEntry.cacheControl));\n            }\n            await sendResponse(nodeNextReq, nodeNextRes, // @ts-expect-error - Argument of type 'Buffer<ArrayBufferLike>' is not assignable to parameter of type 'BodyInit | null | undefined'.\n            new Response(cacheEntry.value.body, {\n                headers,\n                status: cacheEntry.value.status || 200\n            }));\n            return null;\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${srcPage}`,\n                    kind: SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        if (!(err instanceof NoFallbackError)) {\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'App Router',\n                routePath: normalizedSrcPage,\n                routeType: 'route',\n                revalidateReason: getRevalidateReason({\n                    isStaticGeneration,\n                    isOnDemandRevalidate\n                })\n            });\n        }\n        // rethrow so that we can handle serving error page\n        // If this is during static generation, throw the error again.\n        if (isIsr) throw err;\n        // Otherwise, send a 500 response.\n        await sendResponse(nodeNextReq, nodeNextRes, new Response(null, {\n            status: 500\n        }));\n        return null;\n    }\n}\n\n//# sourceMappingURL=app-route.js.map\n","import { NextRequest, NextResponse } from 'next/server';\nimport { convertWordToPdf, htmlToWordBlob } from '@/lib/services/pdfWordConverter';\n\nexport async function POST(req: NextRequest) {\n  try {\n    const { html } = await req.json();\n    if (!html) {\n      return NextResponse.json({ error: 'html is required' }, { status: 400 });\n    }\n    const blob = await htmlToWordBlob(html);\n    const dataUrl = await convertWordToPdf(blob);\n    return NextResponse.json({ pdfDataUrl: dataUrl });\n  } catch (err) {\n    console.error('Export PDF error', err);\n    return NextResponse.json({ error: 'Internal Server Error' }, { status: 500 });\n  }\n}\n\n\n"],"names":[],"mappings":"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","ignoreList":[0,2]}