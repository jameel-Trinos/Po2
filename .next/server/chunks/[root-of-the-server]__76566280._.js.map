{"version":3,"sources":["turbopack:///[project]/lib/pdfStorage.ts"],"sourcesContent":["/**\n * In-memory storage for PDF documents\n * Stores PDFs temporarily for conversion operations\n * \n * Note: This is a simple in-memory solution. For production,\n * consider using Redis, S3, or a database.\n */\n\ninterface StoredPDF {\n  buffer: Buffer;\n  fileName: string;\n  uploadedAt: Date;\n}\n\n// In-memory storage Map\nconst pdfStorage = new Map<string, StoredPDF>();\n\n// Cleanup interval (remove PDFs older than 24 hours)\nconst CLEANUP_INTERVAL = 60 * 60 * 1000; // 1 hour (check every hour)\nconst MAX_AGE = 24 * 60 * 60 * 1000; // 24 hours (keep PDFs for 24 hours)\n\n// Periodic cleanup\nif (typeof setInterval !== 'undefined') {\n  setInterval(() => {\n    const now = new Date();\n    for (const [id, pdf] of pdfStorage.entries()) {\n      const age = now.getTime() - pdf.uploadedAt.getTime();\n      if (age > MAX_AGE) {\n        console.log(`üóëÔ∏è  Cleaning up old PDF: ${id} (${pdf.fileName})`);\n        pdfStorage.delete(id);\n      }\n    }\n  }, CLEANUP_INTERVAL);\n}\n\n/**\n * Store a PDF in memory\n */\nexport function storePDF(documentId: string, buffer: Buffer, fileName: string): void {\n  console.log(`üíæ Storing PDF: ${documentId} (${fileName}, ${buffer.length} bytes)`);\n  pdfStorage.set(documentId, {\n    buffer,\n    fileName,\n    uploadedAt: new Date(),\n  });\n}\n\n/**\n * Retrieve a stored PDF\n */\nexport function getPDF(documentId: string): { buffer: Buffer; fileName: string } | null {\n  const stored = pdfStorage.get(documentId);\n  if (!stored) {\n    console.log(`‚ùå PDF not found: ${documentId}`);\n    return null;\n  }\n  console.log(`‚úÖ Retrieved PDF: ${documentId} (${stored.fileName}, ${stored.buffer.length} bytes)`);\n  return {\n    buffer: stored.buffer,\n    fileName: stored.fileName,\n  };\n}\n\n/**\n * Delete a stored PDF\n */\nexport function deletePDF(documentId: string): boolean {\n  const deleted = pdfStorage.delete(documentId);\n  if (deleted) {\n    console.log(`üóëÔ∏è  Deleted PDF: ${documentId}`);\n  }\n  return deleted;\n}\n\n/**\n * Get storage statistics\n */\nexport function getStorageStats(): { count: number; totalSize: number } {\n  let totalSize = 0;\n  for (const pdf of pdfStorage.values()) {\n    totalSize += pdf.buffer.length;\n  }\n  return {\n    count: pdfStorage.size,\n    totalSize,\n  };\n}\n\n"],"names":[],"mappings":"kjCAeA,IAAM,EAAa,IAAI,IAuBhB,SAAS,EAAS,CAAkB,CAAE,CAAc,CAAE,CAAgB,EAC3E,QAAQ,GAAG,CAAC,CAAC,gBAAgB,EAAE,EAAW,EAAE,EAAE,EAAS,EAAE,EAAE,EAAO,MAAM,CAAC,OAAO,CAAC,EACjF,EAAW,GAAG,CAAC,EAAY,QACzB,WACA,EACA,WAAY,IAAI,IAClB,EACF,CAKO,SAAS,EAAO,CAAkB,EACvC,IAAM,EAAS,EAAW,GAAG,CAAC,UAC9B,AAAK,GAIL,CAJI,IAAS,GAIL,GAAG,CAAC,CAAC,iBAAiB,EAAE,EAAW,EAAE,EAAE,EAAO,QAAQ,CAAC,EAAE,EAAE,EAAO,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,EACzF,CACL,OAAQ,EAAO,MAAM,CACrB,SAAU,EAAO,QACnB,AAD2B,IANzB,QAAQ,GAAG,CAAC,CAAC,iBAAiB,EAAE,EAAA,CAAY,EACrC,KAOX,CAvC2B,aAAvB,AAAoC,OAA7B,aACT,YAAY,KACV,IAAM,EAAM,IAAI,KAChB,IAAK,GAAM,CAAC,EAAI,EAAI,GAAI,EAAW,OAAO,GAAI,AAChC,EAAI,OAAO,GAAK,EAAI,UAAU,CAAC,OAAO,GAPxC,KAAK,GASb,EATkB,KAAK,CASf,GAAG,CAAC,CAAC,AATgB,0BASU,EAAE,EAAG,EAAE,EAAE,EAAI,AATa,QASL,CAAC,CAAC,CAAC,EAC/D,EAAW,MAAM,CAAC,GAGxB,EAduB,CAcpB,IAdyB,KAAK,MAAM,4BAA4B"}