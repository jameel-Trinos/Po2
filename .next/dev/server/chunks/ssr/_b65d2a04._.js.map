{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Trinos/Learning/PointofTwo/Po2/lib/services/geminiService.ts"],"sourcesContent":["import type { Suggestion } from '../types/proofreader';\n\nexport async function analyzePdfContent(pdfTextByPage: string): Promise<Suggestion[]> {\n    try {\n        const response = await fetch('/api/analyze', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({ pdfTextByPage }),\n        });\n\n        if (!response.ok) {\n            const errorData = await response.json().catch(() => ({ error: 'Unknown error' }));\n            throw new Error(errorData.error || `HTTP error! status: ${response.status}`);\n        }\n\n        const data = await response.json();\n        return data.suggestions || [];\n    } catch (error) {\n        console.error(\"Error analyzing content with Gemini:\", error);\n        throw new Error(\"Failed to get suggestions from the AI. Please check the console for details.\");\n    }\n}\n"],"names":[],"mappings":";;;;AAEO,eAAe,kBAAkB,aAAqB;IACzD,IAAI;QACA,MAAM,WAAW,MAAM,MAAM,gBAAgB;YACzC,QAAQ;YACR,SAAS;gBACL,gBAAgB;YACpB;YACA,MAAM,KAAK,SAAS,CAAC;gBAAE;YAAc;QACzC;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YACd,MAAM,YAAY,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC;oBAAE,OAAO;gBAAgB,CAAC;YAC/E,MAAM,IAAI,MAAM,UAAU,KAAK,IAAI,CAAC,oBAAoB,EAAE,SAAS,MAAM,EAAE;QAC/E;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,OAAO,KAAK,WAAW,IAAI,EAAE;IACjC,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,wCAAwC;QACtD,MAAM,IAAI,MAAM;IACpB;AACJ","debugId":null}},
    {"offset": {"line": 36, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Trinos/Learning/PointofTwo/Po2/components/proofreader/icons.tsx"],"sourcesContent":["import React from 'react';\n\nexport const EditIcon: React.FC<React.SVGProps<SVGSVGElement>> = (props) => (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    {...props}\n  >\n    <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\" />\n    <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4Z\" />\n  </svg>\n);\n\nexport const CheckCircleIcon: React.FC<React.SVGProps<SVGSVGElement>> = (props) => (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    {...props}\n  >\n    <path d=\"M22 11.08V12a10 10 0 1 1-5.93-9.14\" />\n    <path d=\"m9 11 3 3L22 4\" />\n  </svg>\n);\n"],"names":[],"mappings":";;;;;;;;AAEO,MAAM,WAAoD,CAAC,sBAChE,8OAAC;QACC,OAAM;QACN,OAAM;QACN,QAAO;QACP,SAAQ;QACR,MAAK;QACL,QAAO;QACP,aAAY;QACZ,eAAc;QACd,gBAAe;QACd,GAAG,KAAK;;0BAET,8OAAC;gBAAK,GAAE;;;;;;0BACR,8OAAC;gBAAK,GAAE;;;;;;;;;;;;AAIL,MAAM,kBAA2D,CAAC,sBACvE,8OAAC;QACC,OAAM;QACN,OAAM;QACN,QAAO;QACP,SAAQ;QACR,MAAK;QACL,QAAO;QACP,aAAY;QACZ,eAAc;QACd,gBAAe;QACd,GAAG,KAAK;;0BAET,8OAAC;gBAAK,GAAE;;;;;;0BACR,8OAAC;gBAAK,GAAE","debugId":null}},
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Trinos/Learning/PointofTwo/Po2/components/proofreader/SuggestionSidebar.tsx"],"sourcesContent":["import React from 'react';\nimport type { Suggestion } from '../../lib/types/proofreader';\nimport { EditIcon, CheckCircleIcon } from './icons';\n\ninterface SuggestionSidebarProps {\n  suggestions: Suggestion[];\n  onSuggestionClick: (suggestion: Suggestion) => void;\n  selectedSuggestion: Suggestion | null;\n  onEditPage: (pageNum: number) => void;\n}\n\nconst SuggestionSidebar: React.FC<SuggestionSidebarProps> = ({ suggestions, onSuggestionClick, selectedSuggestion, onEditPage }) => {\n  return (\n    <div className=\"bg-slate-800/50 border border-slate-700 rounded-xl shadow-lg sticky top-24\">\n      <div className=\"p-4 border-b border-slate-700\">\n        <h2 className=\"text-lg font-semibold text-white\">AI Suggestions ({suggestions.length})</h2>\n      </div>\n      <div className=\"max-h-[calc(100vh-12rem)] overflow-y-auto\">\n        {suggestions.length === 0 ? (\n          <div className=\"p-6 text-center text-slate-400 flex flex-col items-center gap-4\">\n            <CheckCircleIcon className=\"w-12 h-12 text-green-500\" />\n            <p className=\"font-semibold\">No suggestions found!</p>\n            <p>The document looks great from a grammatical standpoint.</p>\n          </div>\n        ) : (\n          <ul className=\"divide-y divide-slate-700\">\n            {suggestions.map((s, index) => (\n              <li\n                key={index}\n                onClick={() => onSuggestionClick(s)}\n                className={`p-4 cursor-pointer transition-colors duration-200 ${selectedSuggestion === s ? 'bg-cyan-900/50' : 'hover:bg-slate-700/50'}`}\n              >\n                <div className=\"flex justify-between items-start mb-2\">\n                    <p className=\"text-sm font-semibold text-cyan-400\">Page {s.page}</p>\n                    <button onClick={(e) => { e.stopPropagation(); onEditPage(s.page); }} className=\"text-xs flex items-center gap-1 text-slate-300 hover:text-white transition-colors\">\n                        <EditIcon className=\"w-3 h-3\"/> Edit Page\n                    </button>\n                </div>\n                <p className=\"text-sm text-slate-400 mb-1 line-through\">{s.original}</p>\n                <p className=\"text-sm text-green-400 font-medium\">\"{s.suggestion}\"</p>\n                <p className=\"text-xs text-slate-500 mt-2 italic\">Reason: {s.explanation}</p>\n              </li>\n            ))}\n          </ul>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default SuggestionSidebar;\n"],"names":[],"mappings":";;;;;AAEA;;;AASA,MAAM,oBAAsD,CAAC,EAAE,WAAW,EAAE,iBAAiB,EAAE,kBAAkB,EAAE,UAAU,EAAE;IAC7H,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAG,WAAU;;wBAAmC;wBAAiB,YAAY,MAAM;wBAAC;;;;;;;;;;;;0BAEvF,8OAAC;gBAAI,WAAU;0BACZ,YAAY,MAAM,KAAK,kBACtB,8OAAC;oBAAI,WAAU;;sCACb,8OAAC,sJAAe;4BAAC,WAAU;;;;;;sCAC3B,8OAAC;4BAAE,WAAU;sCAAgB;;;;;;sCAC7B,8OAAC;sCAAE;;;;;;;;;;;6EAGL,8OAAC;oBAAG,WAAU;8BACX,YAAY,GAAG,CAAC,CAAC,GAAG,sBACnB,8OAAC;4BAEC,SAAS,IAAM,kBAAkB;4BACjC,WAAW,CAAC,kDAAkD,EAAE,uBAAuB,IAAI,mBAAmB,yBAAyB;;8CAEvI,8OAAC;oCAAI,WAAU;;sDACX,8OAAC;4CAAE,WAAU;;gDAAsC;gDAAM,EAAE,IAAI;;;;;;;sDAC/D,8OAAC;4CAAO,SAAS,CAAC;gDAAQ,EAAE,eAAe;gDAAI,WAAW,EAAE,IAAI;4CAAG;4CAAG,WAAU;;8DAC5E,8OAAC,+IAAQ;oDAAC,WAAU;;;;;;gDAAW;;;;;;;;;;;;;8CAGvC,8OAAC;oCAAE,WAAU;8CAA4C,EAAE,QAAQ;;;;;;8CACnE,8OAAC;oCAAE,WAAU;;wCAAqC;wCAAE,EAAE,UAAU;wCAAC;;;;;;;8CACjE,8OAAC;oCAAE,WAAU;;wCAAqC;wCAAS,EAAE,WAAW;;;;;;;;2BAZnE;;;;;;;;;;;;;;;;;;;;;AAoBrB;uCAEe","debugId":null}},
    {"offset": {"line": 281, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Trinos/Learning/PointofTwo/Po2/components/proofreader/EditableHighlight.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport type { Suggestion } from '../../lib/types/proofreader';\nimport { CheckCircleIcon } from './icons';\n\ninterface EditableHighlightProps {\n    suggestion: Suggestion;\n    box: {\n        left: number;\n        top: number;\n        width: number;\n        height: number;\n    };\n    onApplyEdit: (pageNumber: number, originalText: string, newText: string) => void;\n    onCancelEdit: () => void;\n}\n\nconst EditableHighlight: React.FC<EditableHighlightProps> = ({ suggestion, box, onApplyEdit, onCancelEdit }) => {\n    const [editedText, setEditedText] = useState(suggestion.suggestion);\n    const wrapperRef = useRef<HTMLDivElement>(null);\n\n    // Close on click outside\n    useEffect(() => {\n        function handleClickOutside(event: MouseEvent) {\n            if (wrapperRef.current && !wrapperRef.current.contains(event.target as Node)) {\n                onCancelEdit();\n            }\n        }\n        document.addEventListener(\"mousedown\", handleClickOutside);\n        return () => {\n            document.removeEventListener(\"mousedown\", handleClickOutside);\n        };\n    }, [wrapperRef, onCancelEdit]);\n    \n    const handleApply = () => {\n        onApplyEdit(suggestion.page, suggestion.original, editedText);\n    };\n\n    return (\n        <div\n            ref={wrapperRef}\n            className=\"absolute z-10 bg-slate-800 border border-cyan-500 rounded-lg shadow-2xl p-4 w-96 transform -translate-y-full -translate-x-1/2\"\n            style={{\n                left: `${box.left + box.width / 2}px`,\n                top: `${box.top - 10}px`,\n                // Basic boundary detection to prevent going off-screen\n                maxWidth: 'calc(100vw - 32px)', \n            }}\n            onClick={e => e.stopPropagation()}\n        >\n            <div className=\"flex justify-between items-center mb-2\">\n                 <h3 className=\"text-md font-semibold text-white\">Apply Suggestion</h3>\n                 <button onClick={onCancelEdit} className=\"text-slate-400 hover:text-white text-2xl leading-none\">&times;</button>\n            </div>\n\n            <div className=\"space-y-3 text-sm\">\n                <div>\n                    <span className=\"text-slate-400\">Original: </span>\n                    <span className=\"line-through text-red-400\">{suggestion.original}</span>\n                </div>\n                 <p className=\"text-xs text-slate-500 italic\">Reason: {suggestion.explanation}</p>\n                <div>\n                     <label htmlFor=\"suggestion-edit\" className=\"block text-slate-300 font-medium mb-1\">Correction:</label>\n                     <textarea\n                        id=\"suggestion-edit\"\n                        value={editedText}\n                        onChange={(e) => setEditedText(e.target.value)}\n                        className=\"w-full bg-slate-900 border border-slate-600 rounded-md p-2 text-slate-200 focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition text-sm\"\n                        rows={3}\n                     />\n                </div>\n            </div>\n           \n            <div className=\"mt-4 flex justify-end gap-2\">\n                <button\n                    onClick={onCancelEdit}\n                    className=\"px-3 py-1.5 bg-slate-600 hover:bg-slate-700 rounded-md text-white font-semibold transition-colors text-xs\"\n                >\n                    Cancel\n                </button>\n                <button\n                    onClick={handleApply}\n                    className=\"px-3 py-1.5 bg-green-600 hover:bg-green-700 rounded-md text-white font-semibold transition-colors text-xs flex items-center gap-1.5\"\n                >\n                    <CheckCircleIcon className=\"w-4 h-4\" />\n                    Apply Change\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default EditableHighlight;\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAcA,MAAM,oBAAsD,CAAC,EAAE,UAAU,EAAE,GAAG,EAAE,WAAW,EAAE,YAAY,EAAE;IACvG,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC,WAAW,UAAU;IAClE,MAAM,aAAa,IAAA,+MAAM,EAAiB;IAE1C,yBAAyB;IACzB,IAAA,kNAAS,EAAC;QACN,SAAS,mBAAmB,KAAiB;YACzC,IAAI,WAAW,OAAO,IAAI,CAAC,WAAW,OAAO,CAAC,QAAQ,CAAC,MAAM,MAAM,GAAW;gBAC1E;YACJ;QACJ;QACA,SAAS,gBAAgB,CAAC,aAAa;QACvC,OAAO;YACH,SAAS,mBAAmB,CAAC,aAAa;QAC9C;IACJ,GAAG;QAAC;QAAY;KAAa;IAE7B,MAAM,cAAc;QAChB,YAAY,WAAW,IAAI,EAAE,WAAW,QAAQ,EAAE;IACtD;IAEA,qBACI,8OAAC;QACG,KAAK;QACL,WAAU;QACV,OAAO;YACH,MAAM,GAAG,IAAI,IAAI,GAAG,IAAI,KAAK,GAAG,EAAE,EAAE,CAAC;YACrC,KAAK,GAAG,IAAI,GAAG,GAAG,GAAG,EAAE,CAAC;YACxB,uDAAuD;YACvD,UAAU;QACd;QACA,SAAS,CAAA,IAAK,EAAE,eAAe;;0BAE/B,8OAAC;gBAAI,WAAU;;kCACV,8OAAC;wBAAG,WAAU;kCAAmC;;;;;;kCACjD,8OAAC;wBAAO,SAAS;wBAAc,WAAU;kCAAwD;;;;;;;;;;;;0BAGtG,8OAAC;gBAAI,WAAU;;kCACX,8OAAC;;0CACG,8OAAC;gCAAK,WAAU;0CAAiB;;;;;;0CACjC,8OAAC;gCAAK,WAAU;0CAA6B,WAAW,QAAQ;;;;;;;;;;;;kCAEnE,8OAAC;wBAAE,WAAU;;4BAAgC;4BAAS,WAAW,WAAW;;;;;;;kCAC7E,8OAAC;;0CACI,8OAAC;gCAAM,SAAQ;gCAAkB,WAAU;0CAAwC;;;;;;0CACnF,8OAAC;gCACE,IAAG;gCACH,OAAO;gCACP,UAAU,CAAC,IAAM,cAAc,EAAE,MAAM,CAAC,KAAK;gCAC7C,WAAU;gCACV,MAAM;;;;;;;;;;;;;;;;;;0BAKlB,8OAAC;gBAAI,WAAU;;kCACX,8OAAC;wBACG,SAAS;wBACT,WAAU;kCACb;;;;;;kCAGD,8OAAC;wBACG,SAAS;wBACT,WAAU;;0CAEV,8OAAC,sJAAe;gCAAC,WAAU;;;;;;4BAAY;;;;;;;;;;;;;;;;;;;AAM3D;uCAEe","debugId":null}},
    {"offset": {"line": 469, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Trinos/Learning/PointofTwo/Po2/components/proofreader/PdfViewer.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from 'react';\nimport type { Suggestion } from '../../lib/types/proofreader';\nimport EditableHighlight from './EditableHighlight';\n\ninterface PdfViewerProps {\n  extractedText: string;\n  suggestions: Suggestion[];\n  selectedSuggestion: Suggestion | null;\n  onSuggestionClick: (suggestion: Suggestion | null) => void;\n  onApplyEdit: (pageNumber: number, originalText: string, newText: string) => void;\n}\n\nconst PdfViewer: React.FC<PdfViewerProps> = ({\n  extractedText,\n  suggestions,\n  selectedSuggestion,\n  onSuggestionClick,\n  onApplyEdit,\n}) => {\n  const viewerRef = useRef<HTMLDivElement>(null);\n  const [activeHighlightBox, setActiveHighlightBox] = useState<{ left: number; top: number; width: number; height: number } | null>(null);\n\n  const getBoundingBox = useCallback((text: string, original: string, pageContent: string) => {\n    const pageOffset = pageContent.indexOf(text);\n    if (pageOffset === -1) return null;\n\n    const lines = pageContent.substring(0, pageOffset).split('\\n');\n    const lineNumber = lines.length - 1;\n    const charOffsetInLine = lines[lines.length - 1].length;\n\n    // Simplified bounding box calculation for plain text. This would be much more complex with a real PDF viewer.\n    // For now, we'll just approximate a box around the first occurrence of the original text.\n    const dummyElement = document.createElement('span');\n    dummyElement.style.position = 'absolute';\n    dummyElement.style.visibility = 'hidden';\n    dummyElement.textContent = original;\n    viewerRef.current?.appendChild(dummyElement);\n    const rect = dummyElement.getBoundingClientRect();\n    viewerRef.current?.removeChild(dummyElement);\n\n    // These values are highly dependent on the rendering of <pre> and would need fine-tuning\n    // or a more sophisticated text measurement. For a true PDF viewer, this would come from the PDF library.\n    const lineHeight = 20; // Approximation\n    const charWidth = 9;   // Approximation\n\n    const startCharIndex = text.indexOf(original);\n    if (startCharIndex === -1) return null;\n\n    // Calculate approximate position based on character and line numbers\n    // This is a very rough estimation for a plain <pre> tag\n    const containerRect = viewerRef.current?.getBoundingClientRect();\n    if (!containerRect) return null;\n\n    const relativeLeft = charOffsetInLine * charWidth;\n    const relativeTop = lineNumber * lineHeight;\n\n    return {\n      left: containerRect.left + relativeLeft,\n      top: containerRect.top + relativeTop,\n      width: original.length * charWidth,\n      height: lineHeight,\n    };\n  }, []);\n\n  useEffect(() => {\n    if (selectedSuggestion && viewerRef.current) {\n      const pages = extractedText.split(/--- PAGE \\d+ ---\\n/).filter(Boolean);\n      const targetPageContent = pages[selectedSuggestion.page - 1];\n\n      if (targetPageContent) {\n        const box = getBoundingBox(targetPageContent, selectedSuggestion.original, targetPageContent);\n        if (box) {\n          setActiveHighlightBox(box);\n          // Scroll to the highlight\n          window.scrollTo({\n            top: box.top + window.scrollY - 100, // Offset for better visibility\n            behavior: 'smooth',\n          });\n        }\n      }\n    } else {\n      setActiveHighlightBox(null);\n    }\n  }, [selectedSuggestion, extractedText, getBoundingBox]);\n\n  const handleApply = (pageNumber: number, originalText: string, newText: string) => {\n    onApplyEdit(pageNumber, originalText, newText);\n    onSuggestionClick(null); // Close highlight after applying\n  };\n\n  const handleCancel = () => {\n    onSuggestionClick(null); // Close highlight\n  };\n\n  return (\n    <div ref={viewerRef} className=\"relative p-4 bg-zinc-100 dark:bg-zinc-800 rounded-lg shadow-inner min-h-[500px]\">\n      <h2 className=\"text-xl font-semibold text-gray-800 dark:text-gray-100 mb-4\">Document Content</h2>\n      <pre className=\"whitespace-pre-wrap font-mono text-gray-700 dark:text-gray-300 text-sm\">\n        {extractedText.split(/--- PAGE \\d+ ---\\n/).map((pageContent, index) => {\n          if (index === 0 && !pageContent.includes('---')) return null;\n          const [pageNumberStr, ...rest] = pageContent.split(' ---\\n');\n          const currentPageContent = rest.join(' ---\\n');\n          const pageNum = parseInt(pageNumberStr);\n\n          // Highlight original text if it's the selected suggestion's page\n          const highlightedContent = selectedSuggestion && selectedSuggestion.page === pageNum\n            ? currentPageContent.split(selectedSuggestion.original).map((part, i) => (\n                <React.Fragment key={i}>\n                  {part}\n                  {i < currentPageContent.split(selectedSuggestion.original).length - 1 && (\n                    <span className=\"bg-yellow-300 dark:bg-yellow-700 bg-opacity-50 rounded px-0.5 cursor-pointer\"\n                          onClick={() => onSuggestionClick(selectedSuggestion)}>\n                      {selectedSuggestion.original}\n                    </span>\n                  )}\n                </React.Fragment>\n              ))\n            : currentPageContent;\n\n          return (\n            <div key={index} className=\"mb-4\">\n              <h3 className=\"text-lg font-semibold text-blue-600 dark:text-blue-400 mb-2\">Page {pageNumberStr}</h3>\n              <p>{highlightedContent}</p>\n            </div>\n          );\n        })}\n      </pre>\n\n      {selectedSuggestion && activeHighlightBox && (\n        <EditableHighlight\n          suggestion={selectedSuggestion}\n          box={activeHighlightBox}\n          onApplyEdit={handleApply}\n          onCancelEdit={handleCancel}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default PdfViewer;\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 639, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Trinos/Learning/PointofTwo/Po2/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,sKAAO,EAAC,IAAA,6IAAI,EAAC;AACtB","debugId":null}},
    {"offset": {"line": 654, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Trinos/Learning/PointofTwo/Po2/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost:\n          \"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-9 px-4 py-2 has-[>svg]:px-3\",\n        sm: \"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5\",\n        lg: \"h-10 rounded-md px-6 has-[>svg]:px-4\",\n        icon: \"size-9\",\n        \"icon-sm\": \"size-8\",\n        \"icon-lg\": \"size-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction Button({\n  className,\n  variant,\n  size,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,uKAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,wKAAI,GAAG;IAE9B,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 713, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Trinos/Learning/PointofTwo/Po2/components/ui/separator.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Separator({\n  className,\n  orientation = \"horizontal\",\n  decorative = true,\n  ...props\n}: React.ComponentProps<typeof SeparatorPrimitive.Root>) {\n  return (\n    <SeparatorPrimitive.Root\n      data-slot=\"separator\"\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Separator }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,UAAU,EACjB,SAAS,EACT,cAAc,YAAY,EAC1B,aAAa,IAAI,EACjB,GAAG,OACkD;IACrD,qBACE,8OAAC,6KAAuB;QACtB,aAAU;QACV,YAAY;QACZ,aAAa;QACb,WAAW,IAAA,kHAAE,EACX,kKACA;QAED,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 742, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Trinos/Learning/PointofTwo/Po2/components/ui/select.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { CheckIcon, ChevronDownIcon, ChevronUpIcon } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Select({\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Root>) {\n  return <SelectPrimitive.Root data-slot=\"select\" {...props} />\n}\n\nfunction SelectGroup({\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Group>) {\n  return <SelectPrimitive.Group data-slot=\"select-group\" {...props} />\n}\n\nfunction SelectValue({\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Value>) {\n  return <SelectPrimitive.Value data-slot=\"select-value\" {...props} />\n}\n\nfunction SelectTrigger({\n  className,\n  size = \"default\",\n  children,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Trigger> & {\n  size?: \"sm\" | \"default\"\n}) {\n  return (\n    <SelectPrimitive.Trigger\n      data-slot=\"select-trigger\"\n      data-size={size}\n      className={cn(\n        \"border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <SelectPrimitive.Icon asChild>\n        <ChevronDownIcon className=\"size-4 opacity-50\" />\n      </SelectPrimitive.Icon>\n    </SelectPrimitive.Trigger>\n  )\n}\n\nfunction SelectContent({\n  className,\n  children,\n  position = \"popper\",\n  align = \"center\",\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Content>) {\n  return (\n    <SelectPrimitive.Portal>\n      <SelectPrimitive.Content\n        data-slot=\"select-content\"\n        className={cn(\n          \"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md\",\n          position === \"popper\" &&\n            \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n          className\n        )}\n        position={position}\n        align={align}\n        {...props}\n      >\n        <SelectScrollUpButton />\n        <SelectPrimitive.Viewport\n          className={cn(\n            \"p-1\",\n            position === \"popper\" &&\n              \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1\"\n          )}\n        >\n          {children}\n        </SelectPrimitive.Viewport>\n        <SelectScrollDownButton />\n      </SelectPrimitive.Content>\n    </SelectPrimitive.Portal>\n  )\n}\n\nfunction SelectLabel({\n  className,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Label>) {\n  return (\n    <SelectPrimitive.Label\n      data-slot=\"select-label\"\n      className={cn(\"text-muted-foreground px-2 py-1.5 text-xs\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SelectItem({\n  className,\n  children,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Item>) {\n  return (\n    <SelectPrimitive.Item\n      data-slot=\"select-item\"\n      className={cn(\n        \"focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2\",\n        className\n      )}\n      {...props}\n    >\n      <span className=\"absolute right-2 flex size-3.5 items-center justify-center\">\n        <SelectPrimitive.ItemIndicator>\n          <CheckIcon className=\"size-4\" />\n        </SelectPrimitive.ItemIndicator>\n      </span>\n      <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n    </SelectPrimitive.Item>\n  )\n}\n\nfunction SelectSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Separator>) {\n  return (\n    <SelectPrimitive.Separator\n      data-slot=\"select-separator\"\n      className={cn(\"bg-border pointer-events-none -mx-1 my-1 h-px\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SelectScrollUpButton({\n  className,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.ScrollUpButton>) {\n  return (\n    <SelectPrimitive.ScrollUpButton\n      data-slot=\"select-scroll-up-button\"\n      className={cn(\n        \"flex cursor-default items-center justify-center py-1\",\n        className\n      )}\n      {...props}\n    >\n      <ChevronUpIcon className=\"size-4\" />\n    </SelectPrimitive.ScrollUpButton>\n  )\n}\n\nfunction SelectScrollDownButton({\n  className,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.ScrollDownButton>) {\n  return (\n    <SelectPrimitive.ScrollDownButton\n      data-slot=\"select-scroll-down-button\"\n      className={cn(\n        \"flex cursor-default items-center justify-center py-1\",\n        className\n      )}\n      {...props}\n    >\n      <ChevronDownIcon className=\"size-4\" />\n    </SelectPrimitive.ScrollDownButton>\n  )\n}\n\nexport {\n  Select,\n  SelectContent,\n  SelectGroup,\n  SelectItem,\n  SelectLabel,\n  SelectScrollDownButton,\n  SelectScrollUpButton,\n  SelectSeparator,\n  SelectTrigger,\n  SelectValue,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAGA;AACA;AAAA;AAAA;AAEA;AANA;;;;;AAQA,SAAS,OAAO,EACd,GAAG,OAC+C;IAClD,qBAAO,8OAAC,0KAAoB;QAAC,aAAU;QAAU,GAAG,KAAK;;;;;;AAC3D;AAEA,SAAS,YAAY,EACnB,GAAG,OACgD;IACnD,qBAAO,8OAAC,2KAAqB;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AAClE;AAEA,SAAS,YAAY,EACnB,GAAG,OACgD;IACnD,qBAAO,8OAAC,2KAAqB;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AAClE;AAEA,SAAS,cAAc,EACrB,SAAS,EACT,OAAO,SAAS,EAChB,QAAQ,EACR,GAAG,OAGJ;IACC,qBACE,8OAAC,6KAAuB;QACtB,aAAU;QACV,aAAW;QACX,WAAW,IAAA,kHAAE,EACX,gzBACA;QAED,GAAG,KAAK;;YAER;0BACD,8OAAC,0KAAoB;gBAAC,OAAO;0BAC3B,cAAA,8OAAC,2OAAe;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAInC;AAEA,SAAS,cAAc,EACrB,SAAS,EACT,QAAQ,EACR,WAAW,QAAQ,EACnB,QAAQ,QAAQ,EAChB,GAAG,OACkD;IACrD,qBACE,8OAAC,4KAAsB;kBACrB,cAAA,8OAAC,6KAAuB;YACtB,aAAU;YACV,WAAW,IAAA,kHAAE,EACX,ijBACA,aAAa,YACX,mIACF;YAEF,UAAU;YACV,OAAO;YACN,GAAG,KAAK;;8BAET,8OAAC;;;;;8BACD,8OAAC,8KAAwB;oBACvB,WAAW,IAAA,kHAAE,EACX,OACA,aAAa,YACX;8BAGH;;;;;;8BAEH,8OAAC;;;;;;;;;;;;;;;;AAIT;AAEA,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,8OAAC,2KAAqB;QACpB,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,6CAA6C;QAC1D,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAClB,SAAS,EACT,QAAQ,EACR,GAAG,OAC+C;IAClD,qBACE,8OAAC,0KAAoB;QACnB,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,6aACA;QAED,GAAG,KAAK;;0BAET,8OAAC;gBAAK,WAAU;0BACd,cAAA,8OAAC,mLAA6B;8BAC5B,cAAA,8OAAC,qNAAS;wBAAC,WAAU;;;;;;;;;;;;;;;;0BAGzB,8OAAC,8KAAwB;0BAAE;;;;;;;;;;;;AAGjC;AAEA,SAAS,gBAAgB,EACvB,SAAS,EACT,GAAG,OACoD;IACvD,qBACE,8OAAC,+KAAyB;QACxB,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,iDAAiD;QAC9D,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,qBAAqB,EAC5B,SAAS,EACT,GAAG,OACyD;IAC5D,qBACE,8OAAC,oLAA8B;QAC7B,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,wDACA;QAED,GAAG,KAAK;kBAET,cAAA,8OAAC,qOAAa;YAAC,WAAU;;;;;;;;;;;AAG/B;AAEA,SAAS,uBAAuB,EAC9B,SAAS,EACT,GAAG,OAC2D;IAC9D,qBACE,8OAAC,sLAAgC;QAC/B,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,wDACA;QAED,GAAG,KAAK;kBAET,cAAA,8OAAC,2OAAe;YAAC,WAAU;;;;;;;;;;;AAGjC","debugId":null}},
    {"offset": {"line": 976, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Trinos/Learning/PointofTwo/Po2/app/editor/page.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState, useEffect } from 'react';\nimport { useSearchParams } from 'next/navigation';\nimport { useAppContext } from '../../lib/AppContext';\nimport { motion } from 'framer-motion';\nimport { Bold, Italic, Underline, Highlighter, Save, FileDown, FileText, Type } from 'lucide-react';\n\n// import * as pdfjs from 'pdfjs-dist'; // Remove direct import\n\nimport { analyzePdfContent } from '../../lib/services/geminiService';\nimport type { Suggestion } from '../../lib/types/proofreader';\nimport SuggestionSidebar from '../../components/proofreader/SuggestionSidebar';\nimport PdfViewer from '../../components/proofreader/PdfViewer';\n\n// shadcn/ui\nimport { Button } from \"@/components/ui/button\";\nimport { Separator } from \"@/components/ui/separator\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue\n} from \"@/components/ui/select\";\n\n// Placeholder for a Spinner component\nconst Spinner = () => (\n  <div className=\"flex items-center justify-center\">\n    <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 dark:border-gray-100\"></div>\n  </div>\n);\n\nexport default function EditorPage() {\n  const searchParams = useSearchParams();\n  const documentId = searchParams.get('documentId');\n  const { getDocumentContent } = useAppContext();\n\n  const [extractedText, setExtractedText] = useState<string>('');\n  const [suggestions, setSuggestions] = useState<Suggestion[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [selectedSuggestion, setSelectedSuggestion] = useState<Suggestion | null>(null);\n  const [pdfjsLib, setPdfjsLib] = useState<any>(null);\n  const [isEditMode, setIsEditMode] = useState<boolean>(false);\n  const [fontSize, setFontSize] = useState<string>('text-base');\n\n  useEffect(() => {\n    // Dynamically import pdfjs-dist on the client-side\n    const loadPdfjs = async () => {\n      const pdfjs = await import('pdfjs-dist');\n      pdfjs.GlobalWorkerOptions.workerSrc = '/pdf.worker.mjs';\n      setPdfjsLib(pdfjs);\n    };\n    loadPdfjs();\n  }, []);\n\n  useEffect(() => {\n    if (documentId) {\n      const content = getDocumentContent(documentId);\n      if (content) {\n        setExtractedText(content);\n        // Analyze content for suggestions\n        const fetchSuggestions = async () => {\n          setIsLoading(true);\n          setError(null);\n          try {\n            // Ensure pdfjsLib is loaded before calling analyzePdfContent if it internally uses pdfjs-dist\n            // For now, analyzePdfContent doesn't directly use pdfjs-dist, but if it did, we'd await pdfjsLib\n            const aiSuggestions = await analyzePdfContent(content);\n            setSuggestions(aiSuggestions);\n          } catch (e) {\n            console.error(\"Failed to get suggestions from AI:\", e);\n            setError(\"Could not retrieve AI suggestions. Ensure your API_KEY is set.\");\n          } finally {\n            setIsLoading(false);\n          }\n        };\n        fetchSuggestions();\n      } else {\n        setError(\"Document content not found.\");\n      }\n    } else {\n      setError(\"No document ID provided.\");\n    }\n  }, [documentId, getDocumentContent]);\n\n  const handleApplyEdit = (pageNumber: number, originalText: string, newText: string) => {\n    setExtractedText((prevText) => {\n      const pageIdentifier = `--- PAGE ${pageNumber} ---\\n`;\n      const parts = prevText.split(pageIdentifier);\n      if (parts.length > 1) {\n        const beforePage = parts[0];\n        const pageContentAndAfter = parts.slice(1).join(pageIdentifier);\n\n        const pageContentParts = pageContentAndAfter.split(originalText);\n        if (pageContentParts.length > 1) {\n          const newPageContent = pageContentParts[0] + newText + pageContentParts.slice(1).join(originalText);\n          return beforePage + pageIdentifier + newPageContent;\n        }\n      }\n      return prevText;\n    });\n    setSuggestions((prevSuggestions) => prevSuggestions.filter(s => !(s.page === pageNumber && s.original === originalText)));\n    setSelectedSuggestion(null);\n  };\n\n  // Formatting helpers for Edit Mode (simple execCommand fallbacks)\n  const applyFormat = (command: 'bold' | 'italic' | 'underline') => {\n    try {\n      document.execCommand(command);\n    } catch {\n      // noop\n    }\n  };\n\n  const applyHighlight = () => {\n    try {\n      document.execCommand('backColor', false, '#fef08a'); // tailwind yellow-200\n    } catch {\n      // noop\n    }\n  };\n\n  const handleExportPDF = () => {\n    // Simple fallback: open print dialog; users can save as PDF\n    window.print();\n  };\n\n  const handleExportDocx = () => {\n    // Lightweight .doc export by wrapping HTML in a Word-compatible MIME\n    const content = document.getElementById('editable-pane')?.innerHTML || extractedText.replace(/\\n/g, '<br/>');\n    const header = `\n      <html xmlns:o=\"urn:schemas-microsoft-com:office:office\"\n            xmlns:w=\"urn:schemas-microsoft-com:office:word\"\n            xmlns=\"http://www.w3.org/TR/REC-html40\">\n      <head><meta charset=\"utf-8\"><title>Document</title></head><body>`;\n    const footer = `</body></html>`;\n    const sourceHTML = header + content + footer;\n    const blob = new Blob(['\\ufeff', sourceHTML], { type: 'application/msword' });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = 'document.doc';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    URL.revokeObjectURL(url);\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex flex-col items-center justify-center h-screen bg-zinc-50 dark:bg-zinc-950 text-center\">\n        <Spinner />\n        <h2 className=\"mt-4 text-2xl font-semibold text-gray-800 dark:text-gray-100\">Loading Document and Suggestions...</h2>\n        <p className=\"text-gray-600 dark:text-gray-400 mt-2\">Please wait.</p>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"flex flex-col items-center justify-center h-screen bg-zinc-50 dark:bg-zinc-950 text-center text-red-600 dark:text-red-400\">\n        <h2 className=\"text-2xl font-semibold\">Error: {error}</h2>\n        <p className=\"text-gray-600 dark:text-gray-400 mt-2\">Please go back and try uploading again.</p>\n      </div>\n    );\n  }\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{ duration: 0.5 }}\n      className=\"min-h-screen bg-zinc-50 dark:bg-zinc-950 p-4 sm:p-6 lg:p-8 flex justify-center\"\n    >\n      <div className=\"max-w-none w-full bg-white dark:bg-zinc-900 p-4 sm:p-6 rounded-2xl shadow-xl border border-zinc-200 dark:border-zinc-800 flex flex-col gap-4\">\n        <div className=\"flex items-center justify-between\">\n          <h1 className=\"text-xl sm:text-2xl font-semibold text-gray-900 dark:text-gray-50\">Smart Compliance Editor</h1>\n          <div className=\"flex items-center gap-2\">\n            <Button variant={isEditMode ? \"secondary\" : \"default\"} onClick={() => setIsEditMode(v => !v)}>\n              <span className=\"mr-2\">Toggle Edit</span> üìù\n            </Button>\n            <Button variant=\"outline\" onClick={() => console.log('save clicked')}>\n              <Save className=\"h-4 w-4 mr-2\" /> Save\n            </Button>\n            <Button variant=\"outline\" onClick={handleExportPDF}>\n              <FileDown className=\"h-4 w-4 mr-2\" /> Export as PDF\n            </Button>\n            <Button variant=\"outline\" onClick={handleExportDocx}>\n              <FileText className=\"h-4 w-4 mr-2\" /> Export as DOCX\n            </Button>\n          </div>\n        </div>\n\n        {isEditMode && (\n          <motion.div\n            initial={{ opacity: 0, y: -6 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.25 }}\n            className=\"rounded-lg border border-zinc-200 dark:border-zinc-800 bg-zinc-50/60 dark:bg-zinc-900/60 p-3\"\n          >\n            <div className=\"flex flex-wrap items-center gap-2\">\n              <Button size=\"sm\" variant=\"ghost\" onClick={() => applyFormat('bold')}>\n                <Bold className=\"h-4 w-4\" />\n              </Button>\n              <Button size=\"sm\" variant=\"ghost\" onClick={() => applyFormat('italic')}>\n                <Italic className=\"h-4 w-4\" />\n              </Button>\n              <Button size=\"sm\" variant=\"ghost\" onClick={() => applyFormat('underline')}>\n                <Underline className=\"h-4 w-4\" />\n              </Button>\n              <Button size=\"sm\" variant=\"ghost\" onClick={applyHighlight}>\n                <Highlighter className=\"h-4 w-4\" />\n              </Button>\n              <Separator orientation=\"vertical\" className=\"h-6\" />\n              <div className=\"flex items-center gap-2\">\n                <Type className=\"h-4 w-4 text-zinc-500\" />\n                <Select value={fontSize} onValueChange={(v) => setFontSize(v)}>\n                  <SelectTrigger className=\"h-8 w-[120px]\">\n                    <SelectValue placeholder=\"Font size\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"text-sm\">Small</SelectItem>\n                    <SelectItem value=\"text-base\">Normal</SelectItem>\n                    <SelectItem value=\"text-lg\">Large</SelectItem>\n                    <SelectItem value=\"text-xl\">XL</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n          </motion.div>\n        )}\n\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n          <div className=\"md:col-span-2 rounded-xl border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900 p-4\">\n            {!isEditMode ? (\n              <PdfViewer\n                extractedText={extractedText}\n                suggestions={suggestions}\n                selectedSuggestion={selectedSuggestion}\n                onSuggestionClick={setSelectedSuggestion}\n                onApplyEdit={handleApplyEdit}\n              />\n            ) : (\n              <div\n                id=\"editable-pane\"\n                className={`prose prose-zinc dark:prose-invert max-w-none outline-none ${fontSize}`}\n                contentEditable\n                suppressContentEditableWarning\n                dangerouslySetInnerHTML={{\n                  __html: (() => {\n                    const text = extractedText\n                      .split('\\n')\n                      .map(line => line === '' ? '<br/>' : line)\n                      .join('<br/>');\n                    if (!selectedSuggestion) return text;\n                    const { original } = selectedSuggestion;\n                    // naive highlight: first occurrence\n                    return text.replace(\n                      original,\n                      `<mark class=\"bg-yellow-200 dark:bg-yellow-300/40\">${original}</mark>`\n                    );\n                  })()\n                }}\n              />\n            )}\n          </div>\n          <div className=\"md:col-span-1 rounded-xl border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900 p-3\">\n            <SuggestionSidebar\n              suggestions={suggestions}\n              onSuggestionClick={setSelectedSuggestion}\n              selectedSuggestion={selectedSuggestion}\n              onEditPage={(pageNum) => {\n                const suggestionToHighlight = suggestions.find(s => s.page === pageNum);\n                if (suggestionToHighlight) {\n                  setSelectedSuggestion(suggestionToHighlight);\n                }\n              }}\n            />\n          </div>\n        </div>\n      </div>\n    </motion.div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}